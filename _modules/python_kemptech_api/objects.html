

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>python_kemptech_api.objects &mdash; python-kemptech-api 0.7.18 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="python-kemptech-api 0.7.18 documentation" href="../../index.html"/>
        <link rel="up" title="Module code" href="../index.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> python-kemptech-api
          

          
          </a>

          
            
            
              <div class="version">
                0.7.18
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../python_kemptech_api.html">python_kemptech_api package</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">python-kemptech-api</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../index.html">Module code</a> &raquo;</li>
      
    <li>python_kemptech_api.objects</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for python_kemptech_api.objects</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">OrderedDict</span>

<span class="kn">from</span> <span class="nn">python_kemptech_api.api_xml</span> <span class="k">import</span> <span class="p">(</span>
    <span class="n">get_data</span><span class="p">,</span>
    <span class="n">is_successful</span><span class="p">,</span>
    <span class="n">get_error_msg</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">python_kemptech_api.exceptions</span> <span class="k">import</span> <span class="p">(</span>
    <span class="n">KempTechApiException</span><span class="p">,</span>
    <span class="n">SubVsCannotCreateSubVs</span><span class="p">,</span>
    <span class="n">RealServerMissingVirtualServiceInfo</span><span class="p">,</span>
    <span class="n">RealServerMissingLoadmasterInfo</span><span class="p">,</span>
    <span class="n">VirtualServiceACLMissingVirtualServiceInfo</span><span class="p">,</span>
    <span class="n">ValidationError</span><span class="p">,</span>
    <span class="n">RuleMissingLoadmasterInfo</span><span class="p">,</span>
    <span class="n">RangeMissingLoadmasterInfo</span><span class="p">,</span>
    <span class="n">LoadMasterParameterError</span><span class="p">,</span>
    <span class="n">SiteMissingFQDNInfo</span><span class="p">,</span>
    <span class="n">SiteMissingLoadmasterInfo</span><span class="p">,</span>
    <span class="n">ClusterMissingLoadmasterInfo</span><span class="p">,</span>
    <span class="n">CertificateMissingLoadmasterInfo</span><span class="p">,</span>
    <span class="n">CipherListInvalid</span><span class="p">,</span>
    <span class="n">RangeMaskInvalid</span><span class="p">,</span>
    <span class="n">VirtualServiceMissingLoadmasterInfo</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">python_kemptech_api.generic</span> <span class="k">import</span> <span class="n">BaseKempObject</span>
<span class="kn">from</span> <span class="nn">python_kemptech_api.utils</span> <span class="k">import</span> <span class="p">(</span>
    <span class="n">validate_ip</span><span class="p">,</span>
    <span class="n">validate_port</span><span class="p">,</span>
    <span class="n">validate_protocol</span><span class="p">,</span>
    <span class="n">get_sub_vs_list_from_data</span><span class="p">,</span>
    <span class="n">send_response</span><span class="p">,</span>
    <span class="n">cast_to_list</span><span class="p">,</span>
    <span class="n">falsey_to_none</span><span class="p">,</span> <span class="n">build_object</span><span class="p">)</span>

<span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>


<div class="viewcode-block" id="VirtualService"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.VirtualService">[docs]</a><span class="k">class</span> <span class="nc">VirtualService</span><span class="p">(</span><span class="n">BaseKempObject</span><span class="p">):</span>
    <span class="n">_API_ADD</span> <span class="o">=</span> <span class="s2">&quot;/addvs&quot;</span>
    <span class="n">_API_MOD</span> <span class="o">=</span> <span class="s2">&quot;/modvs&quot;</span>
    <span class="n">_API_DELETE</span> <span class="o">=</span> <span class="s2">&quot;/delvs&quot;</span>
    <span class="n">_API_GET</span> <span class="o">=</span> <span class="s2">&quot;/showvs&quot;</span>
    <span class="n">_API_EXPORT</span> <span class="o">=</span> <span class="s2">&quot;/exportvstmplt&quot;</span>
    <span class="n">_API_LIST</span> <span class="o">=</span> <span class="s2">&quot;/listvs&quot;</span>
    <span class="n">API_TAG</span> <span class="o">=</span> <span class="s2">&quot;VS&quot;</span>
    <span class="n">API_INIT_PARAMS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;vs&quot;</span><span class="p">:</span> <span class="s2">&quot;VSAddress&quot;</span><span class="p">,</span>
        <span class="s2">&quot;port&quot;</span><span class="p">:</span> <span class="s2">&quot;VSPort&quot;</span><span class="p">,</span>
        <span class="s2">&quot;prot&quot;</span><span class="p">:</span> <span class="s2">&quot;Protocol&quot;</span>
    <span class="p">}</span>
    <span class="n">_API_BASE_PARAMS</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;vs&quot;</span><span class="p">,</span>
        <span class="s2">&quot;port&quot;</span><span class="p">,</span>
        <span class="s2">&quot;prot&quot;</span>
    <span class="p">]</span>
    <span class="n">_API_DEFAULT_ATTRIBUTES</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;Status&quot;</span><span class="p">,</span>
        <span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="s2">&quot;Index&quot;</span><span class="p">,</span>
        <span class="s2">&quot;vs&quot;</span><span class="p">:</span> <span class="s2">&quot;VSAddress&quot;</span><span class="p">,</span>
        <span class="s2">&quot;altaddress&quot;</span><span class="p">:</span> <span class="s2">&quot;AltAddress&quot;</span><span class="p">,</span>
        <span class="s2">&quot;extraports&quot;</span><span class="p">:</span> <span class="s2">&quot;ExtraPorts&quot;</span><span class="p">,</span>
        <span class="s2">&quot;enable&quot;</span><span class="p">:</span> <span class="s2">&quot;Enable&quot;</span><span class="p">,</span>
        <span class="s2">&quot;vsaddress&quot;</span><span class="p">:</span> <span class="s2">&quot;VSAddress&quot;</span><span class="p">,</span>
        <span class="s2">&quot;vstype&quot;</span><span class="p">:</span> <span class="s2">&quot;VStype&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mastervsid&quot;</span><span class="p">:</span> <span class="s2">&quot;MasterVSID&quot;</span><span class="p">,</span>
        <span class="s2">&quot;nickname&quot;</span><span class="p">:</span> <span class="s2">&quot;NickName&quot;</span><span class="p">,</span>

        <span class="c1"># Scheduling and Persistence</span>
        <span class="s2">&quot;schedule&quot;</span><span class="p">:</span> <span class="s2">&quot;Schedule&quot;</span><span class="p">,</span>
        <span class="s2">&quot;adaptive&quot;</span><span class="p">:</span> <span class="s2">&quot;Adaptive&quot;</span><span class="p">,</span>
        <span class="s2">&quot;persist&quot;</span><span class="p">:</span> <span class="s2">&quot;Persist&quot;</span><span class="p">,</span>
        <span class="s2">&quot;persisttimeout&quot;</span><span class="p">:</span> <span class="s2">&quot;PersistTimeout&quot;</span><span class="p">,</span>
        <span class="s2">&quot;querytag&quot;</span><span class="p">:</span> <span class="s2">&quot;QueryTag&quot;</span><span class="p">,</span>
        <span class="s2">&quot;cookie&quot;</span><span class="p">:</span> <span class="s2">&quot;Cookie&quot;</span><span class="p">,</span>

        <span class="c1"># Advanced</span>
        <span class="s2">&quot;standbyaddr&quot;</span><span class="p">:</span> <span class="s2">&quot;StandbyAddr&quot;</span><span class="p">,</span>
        <span class="s2">&quot;standbyport&quot;</span><span class="p">:</span> <span class="s2">&quot;StandbyPort&quot;</span><span class="p">,</span>
        <span class="s2">&quot;defaultgw&quot;</span><span class="p">:</span> <span class="s2">&quot;DefaultGW&quot;</span><span class="p">,</span>

        <span class="c1"># HTTP</span>
        <span class="s2">&quot;errorcode&quot;</span><span class="p">:</span> <span class="s2">&quot;ErrorCode&quot;</span><span class="p">,</span>
        <span class="s2">&quot;errorurl&quot;</span><span class="p">:</span> <span class="s2">&quot;ErrorUrl&quot;</span><span class="p">,</span>
        <span class="s2">&quot;errorpage&quot;</span><span class="p">:</span> <span class="s2">&quot;ErrorPage&quot;</span><span class="p">,</span>

        <span class="c1"># Healthcheck</span>
        <span class="s2">&quot;checktype&quot;</span><span class="p">:</span> <span class="s2">&quot;CheckType&quot;</span><span class="p">,</span>
        <span class="s2">&quot;checkport&quot;</span><span class="p">:</span> <span class="s2">&quot;CheckPort&quot;</span><span class="p">,</span>
        <span class="s2">&quot;checkurl&quot;</span><span class="p">:</span> <span class="s2">&quot;CheckUrl&quot;</span><span class="p">,</span>
        <span class="s2">&quot;checkheaders&quot;</span><span class="p">:</span> <span class="s2">&quot;CheckHeaders&quot;</span><span class="p">,</span>
        <span class="s2">&quot;checkuse1_1&quot;</span><span class="p">:</span> <span class="s2">&quot;CheckUse1.1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;checkuseget&quot;</span><span class="p">:</span> <span class="s2">&quot;CheckUseGet&quot;</span><span class="p">,</span>
        <span class="s2">&quot;checkpostdata&quot;</span><span class="p">:</span> <span class="s2">&quot;CheckPostData&quot;</span><span class="p">,</span>
        <span class="s2">&quot;checkpattern&quot;</span><span class="p">:</span> <span class="s2">&quot;CheckPattern&quot;</span><span class="p">,</span>
        <span class="s2">&quot;checkcodes&quot;</span><span class="p">:</span> <span class="s2">&quot;CheckCodes&quot;</span><span class="p">,</span>
        <span class="s2">&quot;matchlen&quot;</span><span class="p">:</span> <span class="s2">&quot;MatchLen&quot;</span><span class="p">,</span>
        <span class="s2">&quot;enhancedhealthchecks&quot;</span><span class="p">:</span> <span class="s2">&quot;EnhancedHealthChecks&quot;</span><span class="p">,</span>
        <span class="s2">&quot;rsminimum&quot;</span><span class="p">:</span> <span class="s2">&quot;RsMinimum&quot;</span><span class="p">,</span>

        <span class="c1"># L7</span>
        <span class="s2">&quot;forcel7&quot;</span><span class="p">:</span> <span class="s2">&quot;ForceL7&quot;</span><span class="p">,</span>
        <span class="s2">&quot;transparent&quot;</span><span class="p">:</span> <span class="s2">&quot;Transparent&quot;</span><span class="p">,</span>
        <span class="s2">&quot;subnetoriginating&quot;</span><span class="p">:</span> <span class="s2">&quot;SubnetOriginating&quot;</span><span class="p">,</span>
        <span class="s2">&quot;useforsnat&quot;</span><span class="p">:</span> <span class="s2">&quot;UseforSnat&quot;</span><span class="p">,</span>
        <span class="s2">&quot;localbindaddrs&quot;</span><span class="p">:</span> <span class="s2">&quot;LocalBindAddrs&quot;</span><span class="p">,</span>
        <span class="s2">&quot;serverinit&quot;</span><span class="p">:</span> <span class="s2">&quot;ServerInit&quot;</span><span class="p">,</span>
        <span class="s2">&quot;idletime&quot;</span><span class="p">:</span> <span class="s2">&quot;Idletime&quot;</span><span class="p">,</span>
        <span class="s2">&quot;addvia&quot;</span><span class="p">:</span> <span class="s2">&quot;AddVia&quot;</span><span class="p">,</span>
        <span class="s2">&quot;extrahdrkey&quot;</span><span class="p">:</span> <span class="s2">&quot;ExtraHdrKey&quot;</span><span class="p">,</span>
        <span class="s2">&quot;extrahdrvalue&quot;</span><span class="p">:</span> <span class="s2">&quot;ExtraHdrValue&quot;</span><span class="p">,</span>
        <span class="s2">&quot;qos&quot;</span><span class="p">:</span> <span class="s2">&quot;QoS&quot;</span><span class="p">,</span>

        <span class="c1"># Content Rules</span>
        <span class="s2">&quot;rsruleprecedence&quot;</span><span class="p">:</span> <span class="s2">&quot;RSRulePrecedence&quot;</span><span class="p">,</span>
        <span class="s2">&quot;rsruleprecedencepos&quot;</span><span class="p">:</span> <span class="s2">&quot;RSRulePrecedencePos&quot;</span><span class="p">,</span>

        <span class="c1"># SSL</span>
        <span class="s2">&quot;sslacceleration&quot;</span><span class="p">:</span> <span class="s2">&quot;SSLAcceleration&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sslrewrite&quot;</span><span class="p">:</span> <span class="s2">&quot;SSLRewrite&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sslreverse&quot;</span><span class="p">:</span> <span class="s2">&quot;SSLReverse&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sslreencrypt&quot;</span><span class="p">:</span> <span class="s2">&quot;SSLReencrypt&quot;</span><span class="p">,</span>
        <span class="s2">&quot;starttlsmode&quot;</span><span class="p">:</span> <span class="s2">&quot;StartTLSMode&quot;</span><span class="p">,</span>
        <span class="s2">&quot;tlstype&quot;</span><span class="p">:</span> <span class="s2">&quot;TlsType&quot;</span><span class="p">,</span>
        <span class="s2">&quot;cipherset&quot;</span><span class="p">:</span> <span class="s2">&quot;CipherSet&quot;</span><span class="p">,</span>
        <span class="s2">&quot;certfile&quot;</span><span class="p">:</span> <span class="s2">&quot;CertFile&quot;</span><span class="p">,</span>
        <span class="s2">&quot;clientcert&quot;</span><span class="p">:</span> <span class="s2">&quot;ClientCert&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ocspverify&quot;</span><span class="p">:</span> <span class="s2">&quot;OCSPVerify&quot;</span><span class="p">,</span>
        <span class="s2">&quot;reversesnihostname&quot;</span><span class="p">:</span> <span class="s2">&quot;ReverseSNIHostname&quot;</span><span class="p">,</span>
        <span class="s2">&quot;needhostname&quot;</span><span class="p">:</span> <span class="s2">&quot;NeedHostName&quot;</span><span class="p">,</span>

        <span class="c1"># AFE</span>
        <span class="s2">&quot;multiconnect&quot;</span><span class="p">:</span> <span class="s2">&quot;MultiConnect&quot;</span><span class="p">,</span>
        <span class="s2">&quot;verify&quot;</span><span class="p">:</span> <span class="s2">&quot;Verify&quot;</span><span class="p">,</span>
        <span class="s2">&quot;compress&quot;</span><span class="p">:</span> <span class="s2">&quot;Compress&quot;</span><span class="p">,</span>
        <span class="s2">&quot;cache&quot;</span><span class="p">:</span> <span class="s2">&quot;Cache&quot;</span><span class="p">,</span>
        <span class="s2">&quot;cachepercent&quot;</span><span class="p">:</span> <span class="s2">&quot;CachePercent&quot;</span><span class="p">,</span>

        <span class="c1"># WAF</span>
        <span class="s2">&quot;alertthreshold&quot;</span><span class="p">:</span> <span class="s2">&quot;AlertThreshold&quot;</span><span class="p">,</span>
        <span class="s2">&quot;intercept&quot;</span><span class="p">:</span> <span class="s2">&quot;Intercept&quot;</span><span class="p">,</span>

        <span class="c1"># ESP</span>
        <span class="s2">&quot;espenabled&quot;</span><span class="p">:</span> <span class="s2">&quot;EspEnabled&quot;</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">_ESP_PARAMS</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;espenabled&quot;</span>
    <span class="p">]</span>
    <span class="n">_WAF_PARAMS</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;alertthreshold&quot;</span><span class="p">,</span>
        <span class="s2">&quot;intercept&quot;</span>
    <span class="p">]</span>
    <span class="n">_SSL_PARAMS</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;sslrewrite&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sslreverse&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sslreencrypt&quot;</span><span class="p">,</span>
        <span class="s2">&quot;starttlsmode&quot;</span><span class="p">,</span>
        <span class="s2">&quot;tlstype&quot;</span><span class="p">,</span>
        <span class="s2">&quot;cipherset&quot;</span><span class="p">,</span>
        <span class="s2">&quot;certfile&quot;</span><span class="p">,</span>
        <span class="s2">&quot;clientcert&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ocspverify&quot;</span><span class="p">,</span>
        <span class="s2">&quot;reversesnihostname&quot;</span><span class="p">,</span>
        <span class="s2">&quot;needhostname&quot;</span><span class="p">,</span>
    <span class="p">]</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loadmaster_info</span><span class="p">,</span> <span class="n">vs</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">prot</span><span class="o">=</span><span class="s2">&quot;tcp&quot;</span><span class="p">,</span>
                 <span class="n">is_sub_vs</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Construct VirtualService object.</span>

<span class="sd">        :param loadmaster_info: The loadmaster dict with the endpoint params.</span>
<span class="sd">        :param vs: IP or index of the VS. When creating a subvs you</span>
<span class="sd">               must pass the index and set the is_sub_vs flag to true in order</span>
<span class="sd">               for createsubvs to behave correctly. The index will be</span>
<span class="sd">               overwritten with the index of the newly created subvs on save().</span>
<span class="sd">        :param port: Port of the virtual service.</span>
<span class="sd">        :param prot: Protocol of the virtual service.</span>
<span class="sd">        :param is_sub_vs: Whether or not it is a subvs, mark this as true and</span>
<span class="sd">               pass the parent VS index as the ip_or_index parameter.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># to avoid AttributeErrors later</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_sub_vs</span> <span class="o">=</span> <span class="n">is_sub_vs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subvs_data</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subvs_entries</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">real_servers</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sslrewrite</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">certfile</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_waf</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_esp</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ssl</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_sub_vs</span><span class="p">:</span>
            <span class="c1"># Skip validation when it is a subvs as they do not have ip/port</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vs</span> <span class="o">=</span> <span class="n">vs</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">port</span> <span class="o">=</span> <span class="n">port</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prot</span> <span class="o">=</span> <span class="n">prot</span>

            <span class="n">validate_ip</span><span class="p">(</span><span class="n">vs</span><span class="p">)</span>
            <span class="n">validate_port</span><span class="p">(</span><span class="n">port</span><span class="p">)</span>
            <span class="n">validate_protocol</span><span class="p">(</span><span class="n">prot</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vs</span> <span class="o">=</span> <span class="n">vs</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">endpoint</span> <span class="o">=</span> <span class="n">loadmaster_info</span><span class="p">[</span><span class="s2">&quot;endpoint&quot;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">VirtualServiceMissingLoadmasterInfo</span><span class="p">(</span><span class="s2">&quot;endpoint&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ip_address</span> <span class="o">=</span> <span class="n">loadmaster_info</span><span class="p">[</span><span class="s2">&quot;ip_address&quot;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">VirtualServiceMissingLoadmasterInfo</span><span class="p">(</span><span class="s2">&quot;ip_address&quot;</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">VirtualService</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">loadmaster_info</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cert</span> <span class="o">=</span> <span class="n">loadmaster_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;cert&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vs</span><span class="p">):</span>
                <span class="k">return</span> <span class="s1">&#39;Sub Virtual Service </span><span class="si">{}</span><span class="s1"> on LoadMaster </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">vs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ip_address</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;Virtual Service </span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1">:</span><span class="si">{}</span><span class="s1"> on LoadMaster </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">prot</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">vs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">port</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ip_address</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">servers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span><span class="nb">int</span><span class="p">(</span><span class="n">rs</span><span class="o">.</span><span class="n">rsindex</span><span class="p">):</span> <span class="n">rs</span> <span class="k">for</span> <span class="n">rs</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_real_servers</span><span class="p">()}</span>

<div class="viewcode-block" id="VirtualService.to_api_dict"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.VirtualService.to_api_dict">[docs]</a>    <span class="k">def</span> <span class="nf">to_api_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">api</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">VirtualService</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">to_api_dict</span><span class="p">()</span>

        <span class="k">def</span> <span class="nf">delete_non_existing_parameters</span><span class="p">(</span><span class="n">api_params</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">mode</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">params</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="k">del</span> <span class="n">api_params</span><span class="p">[</span><span class="n">entry</span><span class="p">]</span>
                    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                        <span class="c1"># If it doesn&#39;t exist don&#39;t do anything</span>
                        <span class="k">pass</span>
            <span class="k">return</span> <span class="n">api_params</span>

        <span class="n">api</span> <span class="o">=</span> <span class="n">delete_non_existing_parameters</span><span class="p">(</span><span class="n">api</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_waf</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_WAF_PARAMS</span><span class="p">)</span>
        <span class="n">api</span> <span class="o">=</span> <span class="n">delete_non_existing_parameters</span><span class="p">(</span><span class="n">api</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_esp</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ESP_PARAMS</span><span class="p">)</span>
        <span class="n">api</span> <span class="o">=</span> <span class="n">delete_non_existing_parameters</span><span class="p">(</span><span class="n">api</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ssl</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_SSL_PARAMS</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_sub_vs</span><span class="p">:</span>
                <span class="k">del</span> <span class="n">api</span><span class="p">[</span><span class="s1">&#39;enable&#39;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">return</span> <span class="n">api</span></div>

<div class="viewcode-block" id="VirtualService.export"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.VirtualService.export">[docs]</a>    <span class="k">def</span> <span class="nf">export</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_API_EXPORT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_base_parameters</span><span class="p">())</span></div>

    <span class="k">def</span> <span class="nf">_get_base_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the bare minimum VS parameters. IP, port and protocol&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="s2">&quot;vs&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vs</span><span class="p">,</span>
                <span class="s2">&quot;port&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">port</span><span class="p">,</span>
                <span class="s2">&quot;prot&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">prot</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;vs&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">}</span>

    <span class="k">def</span> <span class="nf">_subvs_to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;vs&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">subvs_data</span><span class="p">[</span><span class="s1">&#39;parentvs&#39;</span><span class="p">],</span>
            <span class="s2">&quot;rs&quot;</span><span class="p">:</span> <span class="s2">&quot;!</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">subvs_data</span><span class="p">[</span><span class="s1">&#39;RsIndex&#39;</span><span class="p">]),</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">subvs_data</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">],</span>
            <span class="s2">&quot;forward&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">subvs_data</span><span class="p">[</span><span class="s1">&#39;Forward&#39;</span><span class="p">],</span>
            <span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">subvs_data</span><span class="p">[</span><span class="s1">&#39;Weight&#39;</span><span class="p">],</span>
            <span class="s2">&quot;limit&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">subvs_data</span><span class="p">[</span><span class="s1">&#39;Limit&#39;</span><span class="p">],</span>
            <span class="s2">&quot;critical&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">subvs_data</span><span class="p">[</span><span class="s1">&#39;Critical&#39;</span><span class="p">],</span>
            <span class="s2">&quot;enable&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">subvs_data</span><span class="p">[</span><span class="s1">&#39;Enable&#39;</span><span class="p">]</span>
        <span class="p">}</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">checkuse1_1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This property exists because . can not be in a variable name.</span>
<span class="sd">        vs.checkuse1_1 is used for access to this variable, but internally the</span>
<span class="sd">        data is stored as obj.checkuse1.1 - this is because in order to write</span>
<span class="sd">        to the API, the parameter uses the string literal &#39;checkuse1.1&#39; &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;checkuse1.1&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="nd">@checkuse1_1</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">checkuse1_1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This property exists because . can not be in a variable name.</span>
<span class="sd">        vs.checkuse1_1 is used for access to this variable, but internally the</span>
<span class="sd">        data is stored as obj.checkuse1.1 - this is because in order to write</span>
<span class="sd">        to the API, the parameter uses the string literal &#39;checkuse1.1&#39; &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s1">&#39;checkuse1.1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

<div class="viewcode-block" id="VirtualService.save"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.VirtualService.save">[docs]</a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="c1"># Parse certfile field if SSL acceleration is enabled</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;sslacceleration&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">sslacceleration</span> <span class="o">==</span> <span class="s2">&quot;Y&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;certfile&quot;</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">certfile</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">certfile</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">certfile</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">certfile</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">certfile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">certfile</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">certfile</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Clear the persist timeout if persistence is not used</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;persist&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">persist</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">persisttimeout</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">subvs_entries</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">enhancedhealthchecks</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">update</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_sub_vs</span><span class="p">:</span>
                <span class="c1"># Hell, thy name be subvs</span>
                <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;/showvs&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_base_parameters</span><span class="p">())</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
                <span class="n">existing_subvs_entries</span> <span class="o">=</span> <span class="n">get_sub_vs_list_from_data</span><span class="p">(</span><span class="n">data</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_base_parameters</span><span class="p">()</span>
                <span class="n">params</span><span class="p">[</span><span class="s2">&quot;createsubvs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;/modvs&quot;</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
                <span class="n">new_subvs_entries</span><span class="p">,</span> <span class="n">subvs_data</span> <span class="o">=</span> <span class="n">get_sub_vs_list_from_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
                <span class="n">s</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">existing_subvs_entries</span><span class="p">)</span>
                <span class="c1"># Subtracts the existing ID&#39;s from the new IDs to know what ID</span>
                <span class="c1"># to use when populating the self&#39;s attributes</span>
                <span class="n">created_subvs_id</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">new_subvs_entries</span>
                                    <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">s</span><span class="p">]</span>
                <span class="n">newly_created_vs_params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;vs&quot;</span><span class="p">:</span> <span class="n">created_subvs_id</span><span class="p">}</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">subvs_data</span> <span class="o">=</span> <span class="n">subvs_data</span><span class="p">[</span><span class="n">created_subvs_id</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">subvs_data</span><span class="p">[</span><span class="s1">&#39;parentvs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vs</span>
                <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;/showvs&quot;</span><span class="p">,</span> <span class="n">newly_created_vs_params</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;/addvs&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_api_dict</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># Update</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_sub_vs</span><span class="p">:</span>
                <span class="c1"># Update the underlying &quot;Rs&quot; part of the subvs as well</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;/modrs&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subvs_to_dict</span><span class="p">())</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;/modvs&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_api_dict</span><span class="p">())</span>

        <span class="k">if</span> <span class="n">is_successful</span><span class="p">(</span><span class="n">response</span><span class="p">):</span>
            <span class="n">vs_data</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">populate_default_attributes</span><span class="p">(</span><span class="n">vs_data</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">KempTechApiException</span><span class="p">(</span><span class="n">get_error_msg</span><span class="p">(</span><span class="n">response</span><span class="p">))</span></div>

<div class="viewcode-block" id="VirtualService.create_sub_virtual_service"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.VirtualService.create_sub_virtual_service">[docs]</a>    <span class="k">def</span> <span class="nf">create_sub_virtual_service</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;VirtualService factory with pre-configured LoadMaster connection</span>

<span class="sd">        When creating a virtual service that is a sub virtual service you must</span>
<span class="sd">        pass the parent index to the constructor and mark the is_sub_vs flag</span>
<span class="sd">        as true. This will allow the save() method on the newly created subvs</span>
<span class="sd">        instance to be able to create a subvs against the parent vs. The index</span>
<span class="sd">        attribute will then be overwritten on save with the subvs&#39;s index.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_sub_vs</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SubVsCannotCreateSubVs</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">VirtualService</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">access_info</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">is_sub_vs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="VirtualService.create_real_server"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.VirtualService.create_real_server">[docs]</a>    <span class="k">def</span> <span class="nf">create_real_server</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ip</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">80</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;RealServer factory with pre-configured LoadMaster connection.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">RealServer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">access_info</span><span class="p">,</span> <span class="n">ip</span><span class="p">,</span> <span class="n">port</span><span class="p">)</span></div>

<div class="viewcode-block" id="VirtualService.create_access_control"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.VirtualService.create_access_control">[docs]</a>    <span class="k">def</span> <span class="nf">create_access_control</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">addvs</span><span class="p">,</span> <span class="n">addr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;AccessControl factory with pre-configured LoadMaster connection and</span>
<span class="sd">        ACL definition.&quot;&quot;&quot;</span>

        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;This method has been deprecated, please manipualte ACL &quot;</span>
                 <span class="s2">&quot;objects directly&quot;</span><span class="p">)</span>

        <span class="n">acl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">acl</span>

        <span class="k">if</span> <span class="n">addvs</span> <span class="o">==</span> <span class="s2">&quot;black&quot;</span><span class="p">:</span>
            <span class="n">acl</span><span class="o">.</span><span class="n">blacklist</span><span class="p">[</span><span class="n">addr</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">elif</span> <span class="n">addvs</span> <span class="o">==</span> <span class="s2">&quot;white&quot;</span><span class="p">:</span>
            <span class="n">acl</span><span class="o">.</span><span class="n">whitelist</span><span class="p">[</span><span class="n">addr</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;ACL List </span><span class="si">%s</span><span class="s2"> is not valid, ACLs have not been modified&quot;</span><span class="p">,</span>
                        <span class="n">addvs</span><span class="p">)</span>

        <span class="n">acl</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">acl</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">acl</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_vs_acl</span><span class="p">()</span>

<div class="viewcode-block" id="VirtualService.get_vs_acl"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.VirtualService.get_vs_acl">[docs]</a>    <span class="k">def</span> <span class="nf">get_vs_acl</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">access_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">access_info</span>
        <span class="n">access_info</span><span class="p">[</span><span class="s2">&quot;ip&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vs</span>
        <span class="n">access_info</span><span class="p">[</span><span class="s2">&quot;port&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">port</span>
        <span class="n">access_info</span><span class="p">[</span><span class="s2">&quot;prot&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prot</span>

        <span class="k">return</span> <span class="n">VirtualServiceACL</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">access_info</span><span class="p">)</span></div>

<div class="viewcode-block" id="VirtualService.get_real_server"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.VirtualService.get_real_server">[docs]</a>    <span class="k">def</span> <span class="nf">get_real_server</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">real_server_address</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">real_server_port</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">validate_port</span><span class="p">(</span><span class="n">real_server_port</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">server_id</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;vs&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vs</span><span class="p">,</span>
                <span class="s2">&quot;port&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">port</span><span class="p">,</span>
                <span class="s2">&quot;prot&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">prot</span><span class="p">,</span>
                <span class="s2">&quot;rs&quot;</span><span class="p">:</span> <span class="n">real_server_address</span><span class="p">,</span>
                <span class="s2">&quot;rsport&quot;</span><span class="p">:</span> <span class="n">real_server_port</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">server_id</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;vs&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                <span class="s2">&quot;rs&quot;</span><span class="p">:</span> <span class="n">real_server_address</span><span class="p">,</span>
                <span class="s2">&quot;rsport&quot;</span><span class="p">:</span> <span class="n">real_server_port</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;/showrs&quot;</span><span class="p">,</span> <span class="n">server_id</span><span class="p">)</span>
        <span class="n">response_data</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
        <span class="n">server</span> <span class="o">=</span> <span class="n">response_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Rs&quot;</span><span class="p">,</span> <span class="p">{})</span>
        <span class="c1"># if there is no Rs key, the following will fail with a ValidationError</span>
        <span class="c1"># which is the best we can do for now</span>
        <span class="n">real_server</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_real_server</span><span class="p">(</span><span class="n">server</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">real_server</span></div>

<div class="viewcode-block" id="VirtualService.get_real_servers"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.VirtualService.get_real_servers">[docs]</a>    <span class="k">def</span> <span class="nf">get_real_servers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;/showvs&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_base_parameters</span><span class="p">())</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
        <span class="n">real_servers</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">servers</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Rs&#39;</span><span class="p">,</span> <span class="p">[])</span>
        <span class="n">servers</span> <span class="o">=</span> <span class="n">cast_to_list</span><span class="p">(</span><span class="n">servers</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">server</span> <span class="ow">in</span> <span class="n">servers</span><span class="p">:</span>
            <span class="n">real_server</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_real_server</span><span class="p">(</span><span class="n">server</span><span class="p">)</span>
            <span class="n">real_servers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">real_server</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">real_servers</span></div>

<div class="viewcode-block" id="VirtualService.build_real_server"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.VirtualService.build_real_server">[docs]</a>    <span class="k">def</span> <span class="nf">build_real_server</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">server</span><span class="p">):</span>
        <span class="k">if</span> <span class="s2">&quot;Addr&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">server</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s1">&#39;&quot;Addr&quot; key not present </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">server</span><span class="p">))</span>
        <span class="k">if</span> <span class="s2">&quot;Port&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">server</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s1">&#39;&quot;Port&quot; key not present </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">server</span><span class="p">))</span>
        <span class="n">real_server</span> <span class="o">=</span> <span class="n">build_object</span><span class="p">(</span><span class="n">RealServer</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">access_info</span><span class="p">,</span> <span class="n">server</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">real_server</span></div>

<div class="viewcode-block" id="VirtualService.populate_default_attributes"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.VirtualService.populate_default_attributes">[docs]</a>    <span class="k">def</span> <span class="nf">populate_default_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">service</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Populate VirtualService instance with standard defaults&quot;&quot;&quot;</span>
        <span class="c1"># pylint: disable=too-many-branches,too-many-statements</span>
        <span class="c1">#super(VirtualService, self).populate_default_attributes(dictionary)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Status&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">enable</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Enable&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forcel7</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ForceL7&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vstype</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;VStype&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schedule</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Schedule&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nickname</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;NickName&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">altaddress</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;AltAddress&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transparent</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Transparent&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">useforsnat</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;UseforSnat&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">persist</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Persist&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cookie</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Cookie&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">extraports</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraPorts&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qos</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;QoS&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">idletime</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Idletime&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mastervsid</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;MasterVSID&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">querytag</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;QueryTag&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serverinit</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ServerInit&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addvia</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;AddVia&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subnetoriginating</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SubnetOriginating&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">localbindaddrs</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;LocalBindAddrs&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">defaultgw</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DefaultGW&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="c1">#self.followvsid = falsey_to_none(int(service.get(&#39;FollowVSID&#39;, 0)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">standbyaddr</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;StandbyAddr&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">standbyport</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;StandbyPort&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">errorcode</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ErrorCode&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">errorurl</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ErrorUrl&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">errorpage</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ErrorPage&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="c1"># WAF</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alertthreshold</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;AlertThreshold&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">intercept</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Intercept&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="c1"># ESP</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">espenabled</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;EspEnabled&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="c1"># Set meta values for whether WAF and ESP are enabled</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alertthreshold</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alertthreshold</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_waf</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_waf</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">espenabled</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">espenabled</span> <span class="o">==</span> <span class="s1">&#39;N&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_esp</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_esp</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">multiconnect</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;MultiConnect&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verify</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Verify&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">compress</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Compress&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cache</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Cache&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cachepercent</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CachePercent&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">sslacceleration</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SSLAcceleration&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sslrewrite</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SSLRewrite&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sslreverse</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SSLReverse&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sslreencrypt</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SSLReencrypt&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">starttlsmode</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;StartTLSMode&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tlstype</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TlsType&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cipherset</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CipherSet&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">certfile</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CertFile&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clientcert</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ClientCert&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ocspverify</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;OCSPVerify&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reversesnihostname</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ReverseSNIHostname&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">needhostname</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;NeedHostName&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sslacceleration</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">sslacceleration</span> <span class="o">==</span> <span class="s1">&#39;N&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ssl</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ssl</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1"># If SSL Acceleration is not enabled, clear the TLS type and Ciphers</span>
        <span class="c1"># These are not valid to set if Acceleration is off</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ssl</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tlstype</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cipherset</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ciphers</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">needhostname</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Rewrite the SSL Rewrite value based on the table:</span>
            <span class="c1"># SSL Rewrite cannot be set as an integer, even</span>
            <span class="c1"># though it outputs as an integer</span>
            <span class="n">sslrewrite</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;0&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                <span class="s2">&quot;1&quot;</span><span class="p">:</span> <span class="s2">&quot;http&quot;</span><span class="p">,</span>
                <span class="s2">&quot;2&quot;</span><span class="p">:</span> <span class="s2">&quot;https&quot;</span>
            <span class="p">}</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># Try casting to an int in the case that the end user passes</span>
                <span class="c1"># the string version of the int.</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sslrewrite</span> <span class="o">=</span> <span class="n">sslrewrite</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sslrewrite</span><span class="p">)]</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">KeyError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sslrewrite</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="c1">#</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">certfile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Splitting certfile field into a list&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">certfile</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">certfile</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">certfile</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="c1"># If there&#39;s just one certificate, identified by a 32 character</span>
            <span class="c1"># hex string, it&#39;s a self signed certificate and the list should</span>
            <span class="c1"># be cleared since setting this value is invalid.</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">certfile</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;[0-9a-f]</span><span class="si">{32}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">certfile</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">certfile</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Real servers section</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checktype</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CheckType&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkhost</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CheckHost&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkpattern</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CheckPattern&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkurl</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CheckUrl&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkcodes</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CheckCodes&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkheaders</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CheckHeaders&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matchlen</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;MatchLen&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkuse1_1</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CheckUse1.1&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkport</span> <span class="o">=</span> <span class="n">falsey_to_none</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CheckPort&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkuseget</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CheckUseGet&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">extrahdrkey</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraHdrKey&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">extrahdrvalue</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraHdrValue&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkpostdata</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CheckPostData&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rsruleprecedence</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;RSRulePrecedence&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rsruleprecedencepos</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;RSRulePrecedencePos&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">enhancedhealthchecks</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;EnhancedHealthChecks&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="c1"># Handle non-standard behavior of Adaptive and Schedule parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">adaptive</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Adaptive&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">adaptive</span> <span class="o">==</span> <span class="s1">&#39;http_rs&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">adaptive</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">schedule</span> <span class="o">=</span> <span class="s1">&#39;adaptive&#39;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">adaptive</span> <span class="o">==</span> <span class="s1">&#39;sdn_gstats&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">adaptive</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">schedule</span> <span class="o">=</span> <span class="s1">&#39;sdn-adaptive&#39;</span>

        <span class="c1"># Disable enable argument if it&#39;s a SubVS</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">enable</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">persisttimeout</span> <span class="o">=</span> <span class="n">falsey_to_none</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="s1">&#39;PersistTimeout&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">rsminimum</span> <span class="o">=</span> <span class="n">falsey_to_none</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;RsMinimum&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)))</span></div></div>


<div class="viewcode-block" id="RealServer"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.RealServer">[docs]</a><span class="k">class</span> <span class="nc">RealServer</span><span class="p">(</span><span class="n">BaseKempObject</span><span class="p">):</span>
    <span class="n">_API_ADD</span> <span class="o">=</span> <span class="s2">&quot;/addrs&quot;</span>
    <span class="n">_API_MOD</span> <span class="o">=</span> <span class="s2">&quot;/modrs&quot;</span>
    <span class="n">_API_DELETE</span> <span class="o">=</span> <span class="s2">&quot;/delrs&quot;</span>
    <span class="n">_API_GET</span> <span class="o">=</span> <span class="s2">&quot;/showrs&quot;</span>
    <span class="n">_API_LIST</span> <span class="o">=</span> <span class="s2">&quot;/showvs&quot;</span>
    <span class="n">API_TAG</span> <span class="o">=</span> <span class="s2">&quot;Rs&quot;</span>
    <span class="n">API_INIT_PARAMS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;ip&quot;</span><span class="p">:</span> <span class="s2">&quot;Addr&quot;</span><span class="p">,</span>
        <span class="s2">&quot;port&quot;</span><span class="p">:</span> <span class="s2">&quot;Port&quot;</span>
    <span class="p">}</span>
    <span class="n">_API_BASE_PARAMS</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;vs&quot;</span><span class="p">,</span>
        <span class="s2">&quot;port&quot;</span><span class="p">,</span>
        <span class="s2">&quot;prot&quot;</span><span class="p">,</span>
        <span class="s2">&quot;rs&quot;</span><span class="p">,</span>
        <span class="s2">&quot;rsport&quot;</span>
    <span class="p">]</span>
    <span class="n">_API_DEFAULT_ATTRIBUTES</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;addr&quot;</span><span class="p">:</span> <span class="s2">&quot;Addr&quot;</span><span class="p">,</span>
        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;Status&quot;</span><span class="p">,</span>
        <span class="s2">&quot;rsindex&quot;</span><span class="p">:</span> <span class="s2">&quot;RsIndex&quot;</span><span class="p">,</span>
        <span class="s2">&quot;vsindex&quot;</span><span class="p">:</span> <span class="s2">&quot;VsIndex&quot;</span><span class="p">,</span>
        <span class="s2">&quot;enable&quot;</span><span class="p">:</span> <span class="s2">&quot;Enable&quot;</span><span class="p">,</span>
        <span class="s2">&quot;forward&quot;</span><span class="p">:</span> <span class="s2">&quot;Forward&quot;</span><span class="p">,</span>
        <span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="s2">&quot;Weight&quot;</span><span class="p">,</span>
        <span class="s2">&quot;limit&quot;</span><span class="p">:</span> <span class="s2">&quot;Limit&quot;</span><span class="p">,</span>
        <span class="s2">&quot;critical&quot;</span><span class="p">:</span> <span class="s2">&quot;Critical&quot;</span><span class="p">,</span>
        <span class="s2">&quot;follow&quot;</span><span class="p">:</span> <span class="s2">&quot;Follow&quot;</span><span class="p">,</span>
        <span class="s2">&quot;dnsname&quot;</span><span class="p">:</span> <span class="s2">&quot;DnsName&quot;</span>
    <span class="p">}</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">rs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;dnsname&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">dnsname</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dnsname</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">addr</span>

    <span class="nd">@rs</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">rs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">validate_ip</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">ValidationError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dnsname</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">addr</span> <span class="o">=</span> <span class="n">value</span>

<div class="viewcode-block" id="RealServer.to_api_dict"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.RealServer.to_api_dict">[docs]</a>    <span class="k">def</span> <span class="nf">to_api_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Populate RS field into dictionary manually</span>
        <span class="n">as_dict</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">RealServer</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">to_api_dict</span><span class="p">()</span>
        <span class="n">as_dict</span><span class="p">[</span><span class="s1">&#39;rs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rs</span>
        <span class="n">as_dict</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;addr&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">as_dict</span></div>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loadmaster_virt_service_info</span><span class="p">,</span> <span class="n">ip</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">80</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rsindex</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rs</span> <span class="o">=</span> <span class="n">ip</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rsport</span> <span class="o">=</span> <span class="n">port</span>
        <span class="n">validate_port</span><span class="p">(</span><span class="n">port</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vs</span> <span class="o">=</span> <span class="n">loadmaster_virt_service_info</span><span class="p">[</span><span class="s2">&quot;vs&quot;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">RealServerMissingVirtualServiceInfo</span><span class="p">(</span><span class="s2">&quot;vs&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">port</span> <span class="o">=</span> <span class="n">loadmaster_virt_service_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;port&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prot</span> <span class="o">=</span> <span class="n">loadmaster_virt_service_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;prot&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">endpoint</span> <span class="o">=</span> <span class="n">loadmaster_virt_service_info</span><span class="p">[</span><span class="s2">&quot;endpoint&quot;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">RealServerMissingLoadmasterInfo</span><span class="p">(</span><span class="s2">&quot;endpoint&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ip_address</span> <span class="o">=</span> <span class="n">loadmaster_virt_service_info</span><span class="p">[</span><span class="s2">&quot;ip_address&quot;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">RealServerMissingLoadmasterInfo</span><span class="p">(</span><span class="s2">&quot;ip_address&quot;</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">RealServer</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">loadmaster_virt_service_info</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cert</span> <span class="o">=</span> <span class="n">loadmaster_virt_service_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;cert&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;Real Server </span><span class="si">{}</span><span class="s1"> on </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vs</span><span class="p">)</span>

<div class="viewcode-block" id="RealServer.save"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.RealServer.save">[docs]</a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">RealServer</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">update</span><span class="p">)</span>
        <span class="c1"># If a new port is set, update the assigned port value</span>
        <span class="c1"># in order to correctly look up the updated RS</span>
        <span class="c1"># If .save fails, this will never be performed</span>
        <span class="k">if</span> <span class="n">update</span> <span class="ow">and</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;newport&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rsport</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">newport</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="BaseACLObject"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.BaseACLObject">[docs]</a><span class="k">class</span> <span class="nc">BaseACLObject</span><span class="p">(</span><span class="n">BaseKempObject</span><span class="p">):</span>
    <span class="n">_API</span> <span class="o">=</span> <span class="s2">&quot;/aclcontrol&quot;</span>
    <span class="n">_API_ADD</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">_API_DEL</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">_API_LIST</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

    <span class="n">API_INIT_PARAMS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="p">}</span>
    <span class="n">_API_BASE_PARAMS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">]</span>
    <span class="n">_API_DEFAULT_ATTRIBUTES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="p">}</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loadmaster_info</span><span class="p">):</span>
        <span class="c1"># Attach to the LoadMaster</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">appliance</span> <span class="o">=</span> <span class="n">loadmaster_info</span><span class="p">[</span><span class="s1">&#39;appliance&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">blacklist</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">whitelist</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">BaseACLObject</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">loadmaster_info</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>

<div class="viewcode-block" id="BaseACLObject.save"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.BaseACLObject.save">[docs]</a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sync</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="nf">_sync</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Sync the blacklist and whitelist to the LoadMaster</span>

        <span class="c1"># Grab the new data and save it before refreshing to get the old data</span>
        <span class="n">new_blacklist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">blacklist</span>
        <span class="n">new_whitelist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">whitelist</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
        <span class="n">old_blacklist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">blacklist</span>
        <span class="n">old_whitelist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">whitelist</span>

        <span class="c1"># Handle the blacklist changes</span>
        <span class="k">for</span> <span class="n">address</span><span class="p">,</span> <span class="n">comment</span> <span class="ow">in</span> <span class="n">old_blacklist</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">address</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">new_blacklist</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_delete_entry</span><span class="p">(</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">address</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">new_blacklist</span><span class="p">[</span><span class="n">address</span><span class="p">]</span> <span class="o">!=</span> <span class="n">comment</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_delete_entry</span><span class="p">(</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">address</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_add_entry</span><span class="p">(</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">new_blacklist</span><span class="p">[</span><span class="n">address</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">address</span><span class="p">,</span> <span class="n">comment</span> <span class="ow">in</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="n">value</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">new_blacklist</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                                 <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">old_blacklist</span><span class="o">.</span><span class="n">keys</span><span class="p">()}</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_entry</span><span class="p">(</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">comment</span><span class="p">)</span>

        <span class="c1"># Now handle the whitelist</span>
        <span class="k">for</span> <span class="n">address</span><span class="p">,</span> <span class="n">comment</span> <span class="ow">in</span> <span class="n">old_whitelist</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">address</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">new_whitelist</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_delete_entry</span><span class="p">(</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">address</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">new_whitelist</span><span class="p">[</span><span class="n">address</span><span class="p">]</span> <span class="o">!=</span> <span class="n">comment</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_delete_entry</span><span class="p">(</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">address</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_add_entry</span><span class="p">(</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">new_whitelist</span><span class="p">[</span><span class="n">address</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">address</span><span class="p">,</span> <span class="n">comment</span> <span class="ow">in</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="n">value</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">new_whitelist</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                                 <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">old_whitelist</span><span class="o">.</span><span class="n">keys</span><span class="p">()}</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_entry</span><span class="p">(</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">comment</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_add_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">list_type</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_base_parameters</span><span class="p">()</span>

        <span class="n">parameters</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_API_ADD</span><span class="p">]</span> <span class="o">=</span> <span class="n">list_type</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;addr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">address</span>

        <span class="c1"># Only valid on 7.2.37.0 and higher</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">appliance</span><span class="p">[</span><span class="s1">&#39;version&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="s2">&quot;7.2.37.0&quot;</span><span class="p">:</span>
            <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;comment&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">comment</span>

        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span>  <span class="c1"># pylint: disable=protected-access</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_API</span><span class="p">,</span>
            <span class="n">parameters</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_successful</span><span class="p">(</span><span class="n">response</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">KempTechApiException</span><span class="p">(</span><span class="n">get_error_msg</span><span class="p">(</span><span class="n">response</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_delete_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">list_type</span><span class="p">,</span> <span class="n">address</span><span class="p">):</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_base_parameters</span><span class="p">()</span>

        <span class="n">parameters</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_API_DEL</span><span class="p">]</span> <span class="o">=</span> <span class="n">list_type</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;addr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">address</span>

        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span>  <span class="c1"># pylint: disable=protected-access</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_API</span><span class="p">,</span>
            <span class="n">parameters</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_successful</span><span class="p">(</span><span class="n">response</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">KempTechApiException</span><span class="p">(</span><span class="n">get_error_msg</span><span class="p">(</span><span class="n">response</span><span class="p">))</span>

<div class="viewcode-block" id="BaseACLObject.refresh"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.BaseACLObject.refresh">[docs]</a>    <span class="k">def</span> <span class="nf">refresh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># First handle whitelist</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_base_parameters</span><span class="p">()</span>

        <span class="n">parameters</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_API_LIST</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;white&quot;</span>

        <span class="n">whitelist_response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span>  <span class="c1"># pylint: disable=protected-access</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_API</span><span class="p">,</span>
            <span class="n">parameters</span><span class="p">)</span>

        <span class="n">whitelist_data</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">whitelist_response</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">VirtualServiceACL</span><span class="p">):</span>
            <span class="n">whitelist_xml</span> <span class="o">=</span> <span class="n">whitelist_data</span><span class="p">[</span><span class="s1">&#39;VS&#39;</span><span class="p">][</span><span class="s1">&#39;Whitelist&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">whitelist_xml</span> <span class="o">=</span> <span class="n">whitelist_data</span><span class="p">[</span><span class="s1">&#39;Whitelist&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">whitelist_xml</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">whitelist</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># Handle pre-7.2.37.0 cases</span>
        <span class="k">elif</span> <span class="s2">&quot;addr&quot;</span> <span class="ow">in</span> <span class="n">whitelist_xml</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">whitelist</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">address</span><span class="p">:</span> <span class="s2">&quot;&quot;</span> <span class="k">for</span>
                <span class="n">address</span> <span class="ow">in</span> <span class="n">cast_to_list</span><span class="p">(</span><span class="n">whitelist_xml</span><span class="p">[</span><span class="s1">&#39;addr&#39;</span><span class="p">])</span>
            <span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">whitelist</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">ip</span><span class="p">[</span><span class="s1">&#39;addr&#39;</span><span class="p">]:</span> <span class="n">ip</span><span class="p">[</span><span class="s1">&#39;comment&#39;</span><span class="p">]</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span>
                <span class="k">for</span> <span class="n">ip</span> <span class="ow">in</span> <span class="n">cast_to_list</span><span class="p">(</span><span class="n">whitelist_xml</span><span class="p">[</span><span class="s1">&#39;IP&#39;</span><span class="p">])</span>
            <span class="p">}</span>

        <span class="c1"># Next verse, same as the first!</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_base_parameters</span><span class="p">()</span>

        <span class="n">parameters</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_API_LIST</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span>

        <span class="n">blacklist_response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span>  <span class="c1"># pylint: disable=protected-access</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_API</span><span class="p">,</span>
            <span class="n">parameters</span><span class="p">)</span>

        <span class="n">blacklist_data</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">blacklist_response</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">VirtualServiceACL</span><span class="p">):</span>
            <span class="n">blacklist_xml</span> <span class="o">=</span> <span class="n">blacklist_data</span><span class="p">[</span><span class="s1">&#39;VS&#39;</span><span class="p">][</span><span class="s1">&#39;Blacklist&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">blacklist_xml</span> <span class="o">=</span> <span class="n">blacklist_data</span><span class="p">[</span><span class="s1">&#39;Blacklist&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">blacklist_xml</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">blacklist</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># Handle pre-7.2.37.0 cases</span>
        <span class="k">elif</span> <span class="s2">&quot;addr&quot;</span> <span class="ow">in</span> <span class="n">blacklist_xml</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">blacklist</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">address</span><span class="p">:</span> <span class="s2">&quot;&quot;</span>
                <span class="k">for</span> <span class="n">address</span> <span class="ow">in</span> <span class="n">cast_to_list</span><span class="p">(</span><span class="n">blacklist_xml</span><span class="p">[</span><span class="s1">&#39;addr&#39;</span><span class="p">])</span>
            <span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">blacklist</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">ip</span><span class="p">[</span><span class="s1">&#39;addr&#39;</span><span class="p">]:</span> <span class="n">ip</span><span class="p">[</span><span class="s1">&#39;comment&#39;</span><span class="p">]</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span>
                <span class="k">for</span> <span class="n">ip</span> <span class="ow">in</span> <span class="n">cast_to_list</span><span class="p">(</span><span class="n">blacklist_xml</span><span class="p">[</span><span class="s1">&#39;IP&#39;</span><span class="p">])</span>
            <span class="p">}</span></div></div>


<div class="viewcode-block" id="GlobalACL"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.GlobalACL">[docs]</a><span class="k">class</span> <span class="nc">GlobalACL</span><span class="p">(</span><span class="n">BaseACLObject</span><span class="p">):</span>
    <span class="n">_API_ADD</span> <span class="o">=</span> <span class="s2">&quot;add&quot;</span>
    <span class="n">_API_DEL</span> <span class="o">=</span> <span class="s2">&quot;del&quot;</span>
    <span class="n">_API_LIST</span> <span class="o">=</span> <span class="s2">&quot;list&quot;</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;Global ACL on </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">appliance</span><span class="p">)</span></div>


<div class="viewcode-block" id="VirtualServiceACL"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.VirtualServiceACL">[docs]</a><span class="k">class</span> <span class="nc">VirtualServiceACL</span><span class="p">(</span><span class="n">BaseACLObject</span><span class="p">):</span>
    <span class="n">_API_ADD</span> <span class="o">=</span> <span class="s2">&quot;addvs&quot;</span>
    <span class="n">_API_DEL</span> <span class="o">=</span> <span class="s2">&quot;delvs&quot;</span>
    <span class="n">_API_LIST</span> <span class="o">=</span> <span class="s2">&quot;listvs&quot;</span>

    <span class="n">_API_BASE_PARAMS</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;vsip&quot;</span><span class="p">,</span>
        <span class="s2">&quot;vsport&quot;</span><span class="p">,</span>
        <span class="s2">&quot;vsprot&quot;</span>
    <span class="p">]</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loadmaster_virt_service_info</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vsip</span> <span class="o">=</span> <span class="n">loadmaster_virt_service_info</span><span class="p">[</span><span class="s2">&quot;vs&quot;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">VirtualServiceACLMissingVirtualServiceInfo</span><span class="p">(</span><span class="s2">&quot;vs&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vsport</span> <span class="o">=</span> <span class="n">loadmaster_virt_service_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;port&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">VirtualServiceACLMissingVirtualServiceInfo</span><span class="p">(</span><span class="s2">&quot;port&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vsprot</span> <span class="o">=</span> <span class="n">loadmaster_virt_service_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;prot&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">VirtualServiceACLMissingVirtualServiceInfo</span><span class="p">(</span><span class="s2">&quot;prot&quot;</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">VirtualServiceACL</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">loadmaster_virt_service_info</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;Virtual Service ACL on </span><span class="si">{}</span><span class="s1">/</span><span class="si">{}</span><span class="s1">:</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vsprot</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vsip</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vsport</span><span class="p">)</span></div>


<div class="viewcode-block" id="Template"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.Template">[docs]</a><span class="k">class</span> <span class="nc">Template</span><span class="p">(</span><span class="n">BaseKempObject</span><span class="p">):</span>
    <span class="n">_API_ADD</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">_API_MOD</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">_API_DELETE</span> <span class="o">=</span> <span class="s2">&quot;/deltemplate&quot;</span>
    <span class="n">_API_GET</span> <span class="o">=</span> <span class="s2">&quot;/listtemplates&quot;</span>
    <span class="n">_API_LIST</span> <span class="o">=</span> <span class="s2">&quot;/listtemplates&quot;</span>
    <span class="n">_API_APPLY</span> <span class="o">=</span> <span class="s2">&quot;/addvs&quot;</span>
    <span class="n">_API_UPLOAD</span> <span class="o">=</span> <span class="s2">&quot;/uploadtemplate&quot;</span>
    <span class="n">API_TAG</span> <span class="o">=</span> <span class="s2">&quot;template&quot;</span>
    <span class="n">API_INIT_PARAMS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;name&quot;</span>
    <span class="p">}</span>
    <span class="n">_API_BASE_PARAMS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;name&quot;</span>
    <span class="p">}</span>
    <span class="n">_API_DEFAULT_ATTRIBUTES</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span>
        <span class="s2">&quot;comment&quot;</span><span class="p">:</span> <span class="s2">&quot;comment&quot;</span><span class="p">,</span>
        <span class="s2">&quot;certified&quot;</span><span class="p">:</span> <span class="s2">&quot;certified&quot;</span>
    <span class="p">}</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loadmaster_info</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">Template</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">loadmaster_info</span><span class="p">)</span>

<div class="viewcode-block" id="Template.save"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.Template.save">[docs]</a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">KempTechApiException</span><span class="p">(</span><span class="s2">&quot;Templates are read-only objects&quot;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Rule"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.Rule">[docs]</a><span class="k">class</span> <span class="nc">Rule</span><span class="p">(</span><span class="n">BaseKempObject</span><span class="p">):</span>
    <span class="n">_API_ADD</span> <span class="o">=</span> <span class="s2">&quot;/addrule&quot;</span>
    <span class="n">_API_MOD</span> <span class="o">=</span> <span class="s2">&quot;/modrule&quot;</span>
    <span class="n">_API_DELETE</span> <span class="o">=</span> <span class="s2">&quot;/delrule&quot;</span>
    <span class="n">_API_GET</span> <span class="o">=</span> <span class="s2">&quot;/showrule&quot;</span>
    <span class="n">_API_LIST</span> <span class="o">=</span> <span class="s2">&quot;/showrule&quot;</span>
    <span class="n">API_INIT_PARAMS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Name&quot;</span><span class="p">,</span>
        <span class="s2">&quot;pattern&quot;</span><span class="p">:</span> <span class="s2">&quot;Pattern&quot;</span>
    <span class="p">}</span>
    <span class="n">_API_BASE_PARAMS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Name&quot;</span><span class="p">,</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Type&quot;</span><span class="p">,</span>
        <span class="s2">&quot;pattern&quot;</span><span class="p">:</span> <span class="s2">&quot;Pattern&quot;</span>
    <span class="p">}</span>
    <span class="n">_API_DEFAULT_ATTRIBUTES</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Name&quot;</span><span class="p">,</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Type&quot;</span><span class="p">,</span>
        <span class="s2">&quot;pattern&quot;</span><span class="p">:</span> <span class="s2">&quot;Pattern&quot;</span><span class="p">,</span>
        <span class="s2">&quot;matchtype&quot;</span><span class="p">:</span> <span class="s2">&quot;MatchType&quot;</span><span class="p">,</span>
        <span class="s2">&quot;addhost&quot;</span><span class="p">:</span> <span class="s2">&quot;AddHost&quot;</span><span class="p">,</span>
        <span class="s2">&quot;negate&quot;</span><span class="p">:</span> <span class="s2">&quot;Negate&quot;</span><span class="p">,</span>
        <span class="s2">&quot;caseindependant&quot;</span><span class="p">:</span> <span class="s2">&quot;CaseIndependent&quot;</span><span class="p">,</span>
        <span class="s2">&quot;includequery&quot;</span><span class="p">:</span> <span class="s2">&quot;IncludeQuery&quot;</span><span class="p">,</span>
        <span class="s2">&quot;header&quot;</span><span class="p">:</span> <span class="s2">&quot;Header&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mustfail&quot;</span><span class="p">:</span> <span class="s2">&quot;MustFail&quot;</span><span class="p">,</span>
        <span class="s2">&quot;headervalue&quot;</span><span class="p">:</span> <span class="s2">&quot;HeaderValue&quot;</span><span class="p">,</span>
        <span class="s2">&quot;replacement&quot;</span><span class="p">:</span> <span class="s2">&quot;Replacement&quot;</span><span class="p">,</span>
        <span class="s2">&quot;setflagonmatch&quot;</span><span class="p">:</span> <span class="s2">&quot;SetFlagOnMatch&quot;</span><span class="p">,</span>
        <span class="s2">&quot;onlyonflag&quot;</span><span class="p">:</span> <span class="s2">&quot;OnlyOnFlag&quot;</span>
    <span class="p">}</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">type_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">types</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;0&quot;</span><span class="p">:</span> <span class="s2">&quot;MatchContentRule&quot;</span><span class="p">,</span>
            <span class="s2">&quot;1&quot;</span><span class="p">:</span> <span class="s2">&quot;AddHeaderRule&quot;</span><span class="p">,</span>
            <span class="s2">&quot;2&quot;</span><span class="p">:</span> <span class="s2">&quot;DeleteHeaderRule&quot;</span><span class="p">,</span>
            <span class="s2">&quot;3&quot;</span><span class="p">:</span> <span class="s2">&quot;ReplaceHeaderRule&quot;</span><span class="p">,</span>
            <span class="s2">&quot;4&quot;</span><span class="p">:</span> <span class="s2">&quot;ModifyURLRule&quot;</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">types</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">)]</span>

    <span class="nd">@type_string</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">type_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="n">types</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;MatchContentRule&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span>
            <span class="s2">&quot;AddHeaderRule&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
            <span class="s2">&quot;DeleteHeaderRule&quot;</span><span class="p">:</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ReplaceHeaderRule&quot;</span><span class="p">:</span> <span class="s2">&quot;3&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ModifyURLRule&quot;</span><span class="p">:</span> <span class="s2">&quot;4&quot;</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">types</span><span class="p">[</span><span class="n">value</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loadmaster_info</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">pattern</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">populate_default_attributes</span><span class="p">({})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pattern</span> <span class="o">=</span> <span class="n">pattern</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">endpoint</span> <span class="o">=</span> <span class="n">loadmaster_info</span><span class="p">[</span><span class="s2">&quot;endpoint&quot;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">RuleMissingLoadmasterInfo</span><span class="p">(</span><span class="s2">&quot;endpoint&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ip_address</span> <span class="o">=</span> <span class="n">loadmaster_info</span><span class="p">[</span><span class="s2">&quot;ip_address&quot;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">RuleMissingLoadmasterInfo</span><span class="p">(</span><span class="s2">&quot;ip_address&quot;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Rule</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">loadmaster_info</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;Rule </span><span class="si">{}</span><span class="s1"> on LoadMaster </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ip_address</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_base_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">base_parameters</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">Rule</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_get_base_parameters</span><span class="p">()</span>

        <span class="c1"># Pattern is not necessary for AddHeader rules</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">base_parameters</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;pattern&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">base_parameters</span>

<div class="viewcode-block" id="Rule.populate_default_attributes"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.Rule.populate_default_attributes">[docs]</a>    <span class="k">def</span> <span class="nf">populate_default_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Populate object instance with standard defaults&quot;&quot;&quot;</span>
        <span class="c1"># Get data from inside tag</span>
        <span class="c1"># Tag is unknown since different rule types have</span>
        <span class="c1"># different tag names. The generic code using API_TAG</span>
        <span class="c1"># isn&#39;t usable in this case.</span>
        <span class="c1">#parameters = parameters.popitem()[1]</span>

        <span class="k">for</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">tag</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_API_DEFAULT_ATTRIBUTES</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">parameters</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">type_string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span></div></div>


<div class="viewcode-block" id="Sso"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.Sso">[docs]</a><span class="k">class</span> <span class="nc">Sso</span><span class="p">(</span><span class="n">BaseKempObject</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loadmaster_info</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">endpoint</span> <span class="o">=</span> <span class="n">loadmaster_info</span><span class="p">[</span><span class="s2">&quot;endpoint&quot;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">RangeMissingLoadmasterInfo</span><span class="p">(</span><span class="s2">&quot;endpoint&quot;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Sso</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">loadmaster_info</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;SSO </span><span class="si">{}</span><span class="s1"> on LoadMaster </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ip_address</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_base_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the bare minimum FQDN parameters.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;domain&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
        <span class="p">}</span>

<div class="viewcode-block" id="Sso.save"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.Sso.save">[docs]</a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">update</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;/adddomain&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_base_parameters</span><span class="p">())</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">is_successful</span><span class="p">(</span><span class="n">response</span><span class="p">):</span>
                <span class="k">raise</span> <span class="n">KempTechApiException</span><span class="p">(</span><span class="n">get_error_msg</span><span class="p">(</span><span class="n">response</span><span class="p">))</span>

        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;/moddomain&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_api_dict</span><span class="p">())</span>

        <span class="k">if</span> <span class="n">is_successful</span><span class="p">(</span><span class="n">response</span><span class="p">):</span>
            <span class="n">sso_data</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">populate_default_attributes</span><span class="p">(</span><span class="n">sso_data</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">KempTechApiException</span><span class="p">(</span><span class="n">get_error_msg</span><span class="p">(</span><span class="n">response</span><span class="p">))</span></div>

<div class="viewcode-block" id="Sso.delete"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.Sso.delete">[docs]</a>    <span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;/deldomain&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_base_parameters</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">send_response</span><span class="p">(</span><span class="n">response</span><span class="p">)</span></div>

<div class="viewcode-block" id="Sso.populate_default_attributes"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.Sso.populate_default_attributes">[docs]</a>    <span class="k">def</span> <span class="nf">populate_default_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sso</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Populate SSO instance with standard defaults&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">sso</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Id&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">sso</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">testuser</span> <span class="o">=</span> <span class="n">sso</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;testuser&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ldap_version</span> <span class="o">=</span> <span class="n">sso</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ldap_version&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">server_side</span> <span class="o">=</span> <span class="n">sso</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;server_side&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">auth_type</span> <span class="o">=</span> <span class="n">sso</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;auth_type&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logon_fmt</span> <span class="o">=</span> <span class="n">sso</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;logon_fmt&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logon_fmt2</span> <span class="o">=</span> <span class="n">sso</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;logon_fmt2&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logon_transcode</span> <span class="o">=</span> <span class="n">sso</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;logon_transcode&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logon_domain</span> <span class="o">=</span> <span class="n">sso</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;logon_domain&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kerberos_domain</span> <span class="o">=</span> <span class="n">sso</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;kerberos_domain&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kerberos_kdc</span> <span class="o">=</span> <span class="n">sso</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;kerberos_kdc&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kcd_username</span> <span class="o">=</span> <span class="n">sso</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;kcd_username&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_failed_auths</span> <span class="o">=</span> <span class="n">sso</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;max_failed_auths&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reset_fail_tout</span> <span class="o">=</span> <span class="n">sso</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;reset_fail_tout&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unblock_tout</span> <span class="o">=</span> <span class="n">sso</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;unblock_tout&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sess_tout_type</span> <span class="o">=</span> <span class="n">sso</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;sess_tout_type&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sess_tout_idle_pub</span> <span class="o">=</span> <span class="n">sso</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;sess_tout_idle_pub&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sess_tout_duration_pub</span> <span class="o">=</span> <span class="n">sso</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;sess_tout_duration_pub&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sess_tout_idle_priv</span> <span class="o">=</span> <span class="n">sso</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;sess_tout_idle_priv&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sess_tout_duration_priv</span> <span class="o">=</span> <span class="n">sso</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;sess_tout_duration_priv&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cert_check_asi</span> <span class="o">=</span> <span class="n">sso</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;cert_check_asi&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Fqdn"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.Fqdn">[docs]</a><span class="k">class</span> <span class="nc">Fqdn</span><span class="p">(</span><span class="n">BaseKempObject</span><span class="p">):</span>
    <span class="n">_API_ADD</span> <span class="o">=</span> <span class="s2">&quot;/addfqdn&quot;</span>
    <span class="n">_API_MOD</span> <span class="o">=</span> <span class="s2">&quot;/modfqdn&quot;</span>
    <span class="n">_API_DELETE</span> <span class="o">=</span> <span class="s2">&quot;/delfqdn&quot;</span>
    <span class="n">_API_GET</span> <span class="o">=</span> <span class="s2">&quot;/showfqdn&quot;</span>
    <span class="n">_API_LIST</span> <span class="o">=</span> <span class="s2">&quot;/listfqdns&quot;</span>
    <span class="n">API_TAG</span> <span class="o">=</span> <span class="s2">&quot;fqdn&quot;</span>
    <span class="n">API_INIT_PARAMS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;fqdn&quot;</span><span class="p">:</span> <span class="s2">&quot;FullyQualifiedDomainName&quot;</span>
    <span class="p">}</span>
    <span class="n">_API_BASE_PARAMS</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;fqdn&quot;</span>
    <span class="p">]</span>
    <span class="n">_API_DEFAULT_ATTRIBUTES</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;fqdn&quot;</span><span class="p">:</span> <span class="s2">&quot;FullyQualifiedDomainName&quot;</span><span class="p">,</span>
        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;Status&quot;</span><span class="p">,</span>
        <span class="s2">&quot;selectioncriteria&quot;</span><span class="p">:</span> <span class="s2">&quot;SelectionCriteria&quot;</span><span class="p">,</span>
        <span class="s2">&quot;failtime&quot;</span><span class="p">:</span> <span class="s2">&quot;FailTime&quot;</span><span class="p">,</span>
        <span class="s2">&quot;siterecoverymode&quot;</span><span class="p">:</span> <span class="s2">&quot;SiteRecoveryMode&quot;</span><span class="p">,</span>
        <span class="s2">&quot;failover&quot;</span><span class="p">:</span> <span class="s2">&quot;failover&quot;</span><span class="p">,</span>
        <span class="s2">&quot;publicrequestvalue&quot;</span><span class="p">:</span> <span class="s2">&quot;publicRequestValue&quot;</span><span class="p">,</span>
        <span class="s2">&quot;privaterequestvalue&quot;</span><span class="p">:</span> <span class="s2">&quot;privateRequestValue&quot;</span><span class="p">,</span>
        <span class="s2">&quot;localsettings&quot;</span><span class="p">:</span> <span class="s2">&quot;LocalSettings&quot;</span><span class="p">,</span>
        <span class="s2">&quot;localttl&quot;</span><span class="p">:</span> <span class="s2">&quot;LocalTTL&quot;</span><span class="p">,</span>
        <span class="s2">&quot;localsticky&quot;</span><span class="p">:</span> <span class="s2">&quot;LocalSticky&quot;</span><span class="p">,</span>
        <span class="s2">&quot;unanimouschecks&quot;</span><span class="p">:</span> <span class="s2">&quot;UnanimousChecks&quot;</span>
    <span class="p">}</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loadmaster_info</span><span class="p">,</span> <span class="n">fqdn</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fqdn</span> <span class="o">=</span> <span class="n">fqdn</span>  <span class="c1"># to avoid AttributeErrors later</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">Fqdn</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">loadmaster_info</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;FQDN </span><span class="si">{}</span><span class="s1"> on LoadMaster </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fqdn</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ip_address</span><span class="p">)</span>

<div class="viewcode-block" id="Fqdn.save"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.Fqdn.save">[docs]</a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">selectioncriteria</span> <span class="o">!=</span> <span class="s2">&quot;lb&quot;</span><span class="p">:</span>
                <span class="c1"># Failover is not available when not using Location Based</span>
                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">failover</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">Fqdn</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">update</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span></div>

<div class="viewcode-block" id="Fqdn.populate_default_attributes"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.Fqdn.populate_default_attributes">[docs]</a>    <span class="k">def</span> <span class="nf">populate_default_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dictionary</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Fqdn</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">populate_default_attributes</span><span class="p">(</span><span class="n">dictionary</span><span class="p">)</span>

        <span class="c1"># Failtime is set by minute, but recorded by second</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Try to cast to integer first</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">failtime</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">failtime</span><span class="p">)</span>
            <span class="c1"># Check if failtime is a non-zero factor of 60</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">failtime</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">failtime</span> <span class="o">%</span> <span class="mi">60</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1"># Convert from seconds to minutes</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">failtime</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">failtime</span> <span class="o">/</span> <span class="mi">60</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">failtime</span> <span class="o">=</span> <span class="kc">None</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">sites</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span><span class="n">site</span><span class="o">.</span><span class="n">ipaddress</span><span class="p">:</span> <span class="n">site</span> <span class="k">for</span> <span class="n">site</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_sites</span><span class="p">()}</span>

<div class="viewcode-block" id="Fqdn.create_site"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.Fqdn.create_site">[docs]</a>    <span class="k">def</span> <span class="nf">create_site</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ip</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Site factory with pre-configured LoadMaster connection.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Site</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">access_info</span><span class="p">,</span> <span class="n">ip</span><span class="p">)</span></div>

<div class="viewcode-block" id="Fqdn.get_site"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.Fqdn.get_site">[docs]</a>    <span class="k">def</span> <span class="nf">get_site</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ip</span><span class="p">):</span>
        <span class="n">validate_ip</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span>

        <span class="n">service_id</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;fqdn&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fqdn</span><span class="p">,</span>
            <span class="s2">&quot;ipaddress&quot;</span><span class="p">:</span> <span class="n">ip</span>
        <span class="p">}</span>

        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;/showfqdn&quot;</span><span class="p">,</span> <span class="n">service_id</span><span class="p">)</span>
        <span class="n">xml_object</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>

        <span class="n">maps</span> <span class="o">=</span> <span class="n">xml_object</span><span class="p">[</span><span class="s2">&quot;fqdn&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Site</span><span class="o">.</span><span class="n">API_TAG</span><span class="p">,</span> <span class="p">{})</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">maps</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">maps</span> <span class="o">=</span> <span class="p">[</span><span class="n">maps</span><span class="p">]</span>

        <span class="nb">map</span> <span class="o">=</span> <span class="p">[</span><span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">maps</span> <span class="k">if</span> <span class="n">m</span><span class="p">[</span><span class="s1">&#39;IPAddress&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">service_id</span><span class="p">[</span><span class="s2">&quot;ipaddress&quot;</span><span class="p">]]</span>

        <span class="c1"># This shouldn&#39;t happen, but we should catch it anyway</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">map</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">LoadMasterParameterError</span><span class="p">(</span>
                <span class="s2">&quot;Unexpected number of matching sites specified.&quot;</span><span class="p">,</span> <span class="nb">map</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">build_object</span><span class="p">(</span><span class="n">Site</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">access_info</span><span class="p">,</span> <span class="nb">map</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span></div>

<div class="viewcode-block" id="Fqdn.get_sites"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.Fqdn.get_sites">[docs]</a>    <span class="k">def</span> <span class="nf">get_sites</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">fqdn</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;fqdn&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fqdn</span>
        <span class="p">}</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_API_LIST</span><span class="p">,</span> <span class="n">fqdn</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
            <span class="n">xml_object</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">API_TAG</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Site</span><span class="o">.</span><span class="n">API_TAG</span><span class="p">,</span> <span class="p">[])</span>
        <span class="k">except</span> <span class="n">KempTechApiException</span><span class="p">:</span>
            <span class="n">xml_object</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">obj_list</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># If there is no API_TAG key, build will fail with a</span>
        <span class="c1"># ValidationError, which is the best we can do for now</span>
        <span class="c1"># (without changing the upstream code and raising an</span>
        <span class="c1"># exception earlier, possibly retrying)</span>

        <span class="n">xml_object</span> <span class="o">=</span> <span class="n">cast_to_list</span><span class="p">(</span><span class="n">xml_object</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xml_object</span><span class="p">:</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_site</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="n">obj_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">obj_list</span></div>

<div class="viewcode-block" id="Fqdn.build_site"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.Fqdn.build_site">[docs]</a>    <span class="k">def</span> <span class="nf">build_site</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">site</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a object instance with standard defaults&quot;&quot;&quot;</span>
        <span class="n">build_parameters</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">parameter</span><span class="p">,</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">Site</span><span class="o">.</span><span class="n">API_INIT_PARAMS</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">build_parameters</span><span class="p">[</span><span class="n">parameter</span><span class="p">]</span> <span class="o">=</span> <span class="n">site</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">tag</span><span class="p">)</span>

        <span class="n">obj</span> <span class="o">=</span> <span class="n">Site</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">access_info</span><span class="p">,</span> <span class="o">**</span><span class="n">build_parameters</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">populate_default_attributes</span><span class="p">(</span><span class="n">site</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">obj</span></div></div>


<div class="viewcode-block" id="Site"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.Site">[docs]</a><span class="k">class</span> <span class="nc">Site</span><span class="p">(</span><span class="n">BaseKempObject</span><span class="p">):</span>
    <span class="n">_API_ADD</span> <span class="o">=</span> <span class="s2">&quot;/addmap&quot;</span>
    <span class="n">_API_MOD</span> <span class="o">=</span> <span class="s2">&quot;/modmap&quot;</span>
    <span class="n">_API_DELETE</span> <span class="o">=</span> <span class="s2">&quot;/delmap&quot;</span>
    <span class="n">_API_GET</span> <span class="o">=</span> <span class="s2">&quot;/showfqdn&quot;</span>
    <span class="n">_API_LIST</span> <span class="o">=</span> <span class="s2">&quot;/showfqdn&quot;</span>
    <span class="n">API_TAG</span> <span class="o">=</span> <span class="s2">&quot;Map&quot;</span>
    <span class="n">API_INIT_PARAMS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;ip&quot;</span><span class="p">:</span> <span class="s2">&quot;IPAddress&quot;</span>
    <span class="p">}</span>
    <span class="n">_API_BASE_PARAMS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;fqdn&quot;</span><span class="p">:</span> <span class="s2">&quot;fqdn&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ip&quot;</span><span class="p">:</span> <span class="s2">&quot;ip&quot;</span>
    <span class="p">}</span>
    <span class="n">_API_DEFAULT_ATTRIBUTES</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="s2">&quot;Index&quot;</span><span class="p">,</span>
        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;Status&quot;</span><span class="p">,</span>
        <span class="s2">&quot;clustervsaddress&quot;</span><span class="p">:</span> <span class="s2">&quot;ClusterVSAddress&quot;</span><span class="p">,</span>
        <span class="s2">&quot;checker&quot;</span><span class="p">:</span> <span class="s2">&quot;Checker&quot;</span><span class="p">,</span>
        <span class="s2">&quot;checkeraddr&quot;</span><span class="p">:</span> <span class="s2">&quot;checkerAddr&quot;</span><span class="p">,</span>
        <span class="s2">&quot;checkerport&quot;</span><span class="p">:</span> <span class="s2">&quot;CheckerPort&quot;</span><span class="p">,</span>
        <span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="s2">&quot;Weight&quot;</span><span class="p">,</span>
        <span class="s2">&quot;enable&quot;</span><span class="p">:</span> <span class="s2">&quot;Enable&quot;</span><span class="p">,</span>
        <span class="s2">&quot;locationlatitude&quot;</span><span class="p">:</span> <span class="s2">&quot;LocationLatitude&quot;</span><span class="p">,</span>
        <span class="s2">&quot;locationlongitude&quot;</span><span class="p">:</span> <span class="s2">&quot;LocationLongitude&quot;</span><span class="p">,</span>
        <span class="s2">&quot;continent&quot;</span><span class="p">:</span> <span class="s2">&quot;continent&quot;</span><span class="p">,</span>
        <span class="s2">&quot;country&quot;</span><span class="p">:</span> <span class="s2">&quot;country&quot;</span><span class="p">,</span>
        <span class="s2">&quot;customlocation&quot;</span><span class="p">:</span> <span class="s2">&quot;customLocation&quot;</span><span class="p">,</span>
        <span class="s2">&quot;cluster&quot;</span><span class="p">:</span> <span class="s2">&quot;Cluster&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mapaddress&quot;</span><span class="p">:</span> <span class="s2">&quot;MappedAddress&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mapport&quot;</span><span class="p">:</span> <span class="s2">&quot;MappedPort&quot;</span>
    <span class="p">}</span>
    <span class="n">_API_IGNORE</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;log_urls&quot;</span><span class="p">,</span> <span class="s2">&quot;ip_address&quot;</span><span class="p">,</span> <span class="s2">&quot;endpoint&quot;</span><span class="p">,</span> <span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="s2">&quot;status&quot;</span><span class="p">,</span>
        <span class="s2">&quot;continent&quot;</span><span class="p">,</span> <span class="s2">&quot;country&quot;</span><span class="p">,</span> <span class="s2">&quot;customlocation&quot;</span><span class="p">,</span> <span class="s2">&quot;ipaddress&quot;</span>
    <span class="p">)</span>

    <span class="c1"># Remap ipaddress to ip because the API is inconsistent</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ipaddress</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ip</span>

    <span class="nd">@ipaddress</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">ipaddress</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ip</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">mappedaddress</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mapaddress</span>

    <span class="nd">@mappedaddress</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">mappedaddress</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mapaddress</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">mappedport</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mapport</span>

    <span class="nd">@mappedport</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">mappedport</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mapport</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loadmaster_fqdn_info</span><span class="p">,</span> <span class="n">ip</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fqdn</span> <span class="o">=</span> <span class="n">loadmaster_fqdn_info</span><span class="p">[</span><span class="s2">&quot;fqdn&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ip</span> <span class="o">=</span> <span class="n">ip</span>
        <span class="n">validate_ip</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fqdn</span> <span class="o">=</span> <span class="n">loadmaster_fqdn_info</span><span class="p">[</span><span class="s2">&quot;fqdn&quot;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SiteMissingFQDNInfo</span><span class="p">(</span><span class="s2">&quot;fqdn&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">endpoint</span> <span class="o">=</span> <span class="n">loadmaster_fqdn_info</span><span class="p">[</span><span class="s2">&quot;endpoint&quot;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SiteMissingLoadmasterInfo</span><span class="p">(</span><span class="s2">&quot;endpoint&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ip_address</span> <span class="o">=</span> <span class="n">loadmaster_fqdn_info</span><span class="p">[</span><span class="s2">&quot;ip_address&quot;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SiteMissingLoadmasterInfo</span><span class="p">(</span><span class="s2">&quot;ip_address&quot;</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">Site</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">loadmaster_fqdn_info</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;Site </span><span class="si">{}</span><span class="s1"> in FQDN </span><span class="si">{}</span><span class="s1"> on LoadMaster </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ip</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fqdn</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ip_address</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_base_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;fqdn&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fqdn</span><span class="p">,</span>
            <span class="s2">&quot;ip&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ip</span>
        <span class="p">}</span>

<div class="viewcode-block" id="Site.populate_default_attributes"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.Site.populate_default_attributes">[docs]</a>    <span class="k">def</span> <span class="nf">populate_default_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dictionary</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Site</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">populate_default_attributes</span><span class="p">(</span><span class="n">dictionary</span><span class="p">)</span>

        <span class="c1"># Fix annoying API inconsistencies</span>

        <span class="c1"># Normalize location lists so we always get a regular list</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">continent</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">continent</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">continent</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">continent</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">continent</span><span class="p">]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">country</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">country</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">country</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">country</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">country</span><span class="p">]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">customlocation</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">customlocation</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">customlocation</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">customlocation</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">customlocation</span><span class="p">]</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">checkerport</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">checkerport</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">checkerport</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkerport</span> <span class="o">&lt;</span> <span class="mi">65530</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">checkerport</span> <span class="o">=</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="Site.save"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.Site.save">[docs]</a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">update</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_API_ADD</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_base_parameters</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_API_MOD</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_api_dict</span><span class="p">())</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_successful</span><span class="p">(</span><span class="n">response</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">KempTechApiException</span><span class="p">(</span><span class="n">get_error_msg</span><span class="p">(</span><span class="n">response</span><span class="p">))</span>

        <span class="c1"># Secondary request is needed because the add/mod action</span>
        <span class="c1"># does not return any data. Therefore, we need to explicitly</span>
        <span class="c1"># retrieve the info.</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_API_GET</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_base_parameters</span><span class="p">())</span>

        <span class="k">if</span> <span class="n">is_successful</span><span class="p">(</span><span class="n">response</span><span class="p">):</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_API_GET</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_base_parameters</span><span class="p">())</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
            <span class="n">maps</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;fqdn&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">API_TAG</span><span class="p">,</span> <span class="p">{})</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">maps</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">maps</span> <span class="o">=</span> <span class="p">[</span><span class="n">maps</span><span class="p">]</span>

            <span class="nb">map</span> <span class="o">=</span> <span class="p">[</span><span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">maps</span> <span class="k">if</span> <span class="n">m</span><span class="p">[</span><span class="s1">&#39;IPAddress&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">ipaddress</span><span class="p">]</span>

            <span class="c1"># This shouldn&#39;t happen, but we should catch it anyway</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">map</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">LoadMasterParameterError</span><span class="p">(</span>
                    <span class="s2">&quot;Multiple matching sites specified.&quot;</span><span class="p">,</span>
                    <span class="nb">map</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">map</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">LoadMasterParameterError</span><span class="p">(</span>
                    <span class="s2">&quot;No matching sites specified.&quot;</span><span class="p">,</span>
                    <span class="nb">map</span><span class="p">)</span>

            <span class="n">site</span> <span class="o">=</span> <span class="nb">map</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">populate_default_attributes</span><span class="p">(</span><span class="n">site</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">KempTechApiException</span><span class="p">(</span><span class="n">get_error_msg</span><span class="p">(</span><span class="n">response</span><span class="p">))</span></div>

<div class="viewcode-block" id="Site.refresh"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.Site.refresh">[docs]</a>    <span class="k">def</span> <span class="nf">refresh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_API_GET</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_get_base_parameters</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">is_successful</span><span class="p">(</span><span class="n">response</span><span class="p">):</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_API_GET</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_base_parameters</span><span class="p">())</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
            <span class="n">maps</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;fqdn&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">API_TAG</span><span class="p">,</span> <span class="p">{})</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">maps</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">maps</span> <span class="o">=</span> <span class="p">[</span><span class="n">maps</span><span class="p">]</span>

            <span class="nb">map</span> <span class="o">=</span> <span class="p">[</span><span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">maps</span> <span class="k">if</span> <span class="n">m</span><span class="p">[</span><span class="s1">&#39;IPAddress&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">ipaddress</span><span class="p">]</span>

            <span class="c1"># This shouldn&#39;t happen, but we should catch it anyway</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">map</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">LoadMasterParameterError</span><span class="p">(</span>
                    <span class="s2">&quot;Multiple matching sites specified.&quot;</span><span class="p">,</span>
                    <span class="nb">map</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">map</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">LoadMasterParameterError</span><span class="p">(</span>
                    <span class="s2">&quot;No matching sites specified.&quot;</span><span class="p">,</span>
                    <span class="nb">map</span><span class="p">)</span>

            <span class="n">site</span> <span class="o">=</span> <span class="nb">map</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">populate_default_attributes</span><span class="p">(</span><span class="n">site</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">KempTechApiException</span><span class="p">(</span><span class="n">get_error_msg</span><span class="p">(</span><span class="n">response</span><span class="p">))</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">locations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;continent&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">continent</span><span class="p">,</span>
            <span class="s2">&quot;country&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">country</span><span class="p">,</span>
            <span class="s2">&quot;customlocation&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">customlocation</span>
        <span class="p">}</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">__get_map_parameters</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="n">is_continent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">is_custom</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">is_custom</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;countrycode&quot;</span><span class="p">:</span> <span class="n">location</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
            <span class="p">}</span>

            <span class="k">if</span> <span class="n">is_continent</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;iscontinent&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;yes&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;iscontinent&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;no&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;customlocation&quot;</span><span class="p">:</span> <span class="n">location</span>
            <span class="p">}</span>

        <span class="k">return</span> <span class="n">parameters</span>

    <span class="k">def</span> <span class="nf">__mod_location</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">is_continent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">is_custom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                       <span class="n">remove</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__get_map_parameters</span><span class="p">(</span><span class="n">location</span><span class="p">,</span>
                                               <span class="n">is_continent</span><span class="p">,</span>
                                               <span class="n">is_custom</span><span class="p">)</span>
        <span class="n">parameters</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_base_parameters</span><span class="p">())</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">remove</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/addcountry&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/removecountry&quot;</span>

        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">is_successful</span><span class="p">(</span><span class="n">response</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">KempTechApiException</span><span class="p">(</span><span class="n">get_error_msg</span><span class="p">(</span><span class="n">response</span><span class="p">))</span>

<div class="viewcode-block" id="Site.set_locations"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.Site.set_locations">[docs]</a>    <span class="k">def</span> <span class="nf">set_locations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">locations</span><span class="p">):</span>

        <span class="c1"># Remove all existing locations</span>
        <span class="k">for</span> <span class="n">location</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">continent</span> <span class="ow">or</span> <span class="p">[]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remove_location</span><span class="p">(</span><span class="n">location</span><span class="p">[</span><span class="s1">&#39;code&#39;</span><span class="p">],</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">location</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">country</span> <span class="ow">or</span> <span class="p">[]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remove_location</span><span class="p">(</span><span class="n">location</span><span class="p">[</span><span class="s1">&#39;code&#39;</span><span class="p">],</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">location</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">customlocation</span> <span class="ow">or</span> <span class="p">[]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remove_location</span><span class="p">(</span><span class="n">location</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Add new set of locations</span>
        <span class="k">for</span> <span class="n">location</span> <span class="ow">in</span> <span class="n">locations</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;continent&quot;</span><span class="p">,</span> <span class="p">[]):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_location</span><span class="p">(</span><span class="n">location</span><span class="p">[</span><span class="s1">&#39;code&#39;</span><span class="p">],</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">location</span> <span class="ow">in</span> <span class="n">locations</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;country&quot;</span><span class="p">,</span> <span class="p">[]):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_location</span><span class="p">(</span><span class="n">location</span><span class="p">[</span><span class="s1">&#39;code&#39;</span><span class="p">],</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">location</span> <span class="ow">in</span> <span class="n">locations</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;customlocation&quot;</span><span class="p">,</span> <span class="p">[]):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_location</span><span class="p">(</span><span class="n">location</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span></div>

<div class="viewcode-block" id="Site.add_location"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.Site.add_location">[docs]</a>    <span class="k">def</span> <span class="nf">add_location</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_continent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">is_custom</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__mod_location</span><span class="p">(</span><span class="n">location</span><span class="p">,</span>
                            <span class="n">is_continent</span><span class="p">,</span>
                            <span class="n">is_custom</span><span class="p">,</span>
                            <span class="n">remove</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="Site.remove_location"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.Site.remove_location">[docs]</a>    <span class="k">def</span> <span class="nf">remove_location</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">is_continent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">is_custom</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__mod_location</span><span class="p">(</span><span class="n">location</span><span class="p">,</span>
                            <span class="n">is_continent</span><span class="p">,</span>
                            <span class="n">is_custom</span><span class="p">,</span>
                            <span class="n">remove</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="Site.set_coordinates"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.Site.set_coordinates">[docs]</a>    <span class="k">def</span> <span class="nf">set_coordinates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">latitude</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">longitude</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">latitude</span> <span class="o">=</span> <span class="n">latitude</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">locationlatitude</span>
        <span class="n">longitude</span> <span class="o">=</span> <span class="n">longitude</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">locationlongitude</span>

        <span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="n">latitude</span><span class="p">,</span>
            <span class="s2">&quot;long&quot;</span><span class="p">:</span> <span class="n">longitude</span>
        <span class="p">}</span>

        <span class="n">parameters</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_base_parameters</span><span class="p">())</span>

        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/changemaploc&quot;</span>

        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">is_successful</span><span class="p">(</span><span class="n">response</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">KempTechApiException</span><span class="p">(</span><span class="n">get_error_msg</span><span class="p">(</span><span class="n">response</span><span class="p">))</span></div></div>


<div class="viewcode-block" id="Cluster"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.Cluster">[docs]</a><span class="k">class</span> <span class="nc">Cluster</span><span class="p">(</span><span class="n">BaseKempObject</span><span class="p">):</span>
    <span class="n">_API_ADD</span> <span class="o">=</span> <span class="s2">&quot;/addcluster&quot;</span>
    <span class="n">_API_MOD</span> <span class="o">=</span> <span class="s2">&quot;/modcluster&quot;</span>
    <span class="n">_API_DELETE</span> <span class="o">=</span> <span class="s2">&quot;/delcluster&quot;</span>
    <span class="n">_API_GET</span> <span class="o">=</span> <span class="s2">&quot;/showcluster&quot;</span>
    <span class="n">_API_LIST</span> <span class="o">=</span> <span class="s2">&quot;/listclusters&quot;</span>
    <span class="n">API_TAG</span> <span class="o">=</span> <span class="s2">&quot;cluster&quot;</span>
    <span class="n">API_INIT_PARAMS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;ip&quot;</span><span class="p">:</span> <span class="s2">&quot;IPAddress&quot;</span><span class="p">,</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Name&quot;</span>
    <span class="p">}</span>
    <span class="n">_API_BASE_PARAMS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;ip&quot;</span><span class="p">:</span> <span class="s2">&quot;IPAddress&quot;</span><span class="p">,</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Name&quot;</span>
    <span class="p">}</span>
    <span class="n">_API_DEFAULT_ATTRIBUTES</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;Status&quot;</span><span class="p">,</span>
        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;Index&quot;</span><span class="p">,</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Name&quot;</span><span class="p">,</span>
        <span class="s2">&quot;checker&quot;</span><span class="p">:</span> <span class="s2">&quot;Checker&quot;</span><span class="p">,</span>
        <span class="s2">&quot;checkerport&quot;</span><span class="p">:</span> <span class="s2">&quot;CheckerPort&quot;</span><span class="p">,</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Type&quot;</span><span class="p">,</span>
        <span class="s2">&quot;enable&quot;</span><span class="p">:</span> <span class="s2">&quot;Enable&quot;</span><span class="p">,</span>
        <span class="s2">&quot;locationlatitude&quot;</span><span class="p">:</span> <span class="s2">&quot;LocationLatitude&quot;</span><span class="p">,</span>
        <span class="s2">&quot;locationlongitude&quot;</span><span class="p">:</span> <span class="s2">&quot;LocationLongitude&quot;</span><span class="p">,</span>
        <span class="s2">&quot;clustervsaddress&quot;</span><span class="p">:</span> <span class="s2">&quot;ClusterVSAddress&quot;</span>
    <span class="p">}</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loadmaster_info</span><span class="p">,</span> <span class="n">ip</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ip</span> <span class="o">=</span> <span class="n">ip</span>
        <span class="n">validate_ip</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">endpoint</span> <span class="o">=</span> <span class="n">loadmaster_info</span><span class="p">[</span><span class="s2">&quot;endpoint&quot;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ClusterMissingLoadmasterInfo</span><span class="p">(</span><span class="s2">&quot;endpoint&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ip_address</span> <span class="o">=</span> <span class="n">loadmaster_info</span><span class="p">[</span><span class="s2">&quot;ip_address&quot;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ClusterMissingLoadmasterInfo</span><span class="p">(</span><span class="s2">&quot;ip_address&quot;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Cluster</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">loadmaster_info</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;Cluster </span><span class="si">{}</span><span class="s1"> at </span><span class="si">{}</span><span class="s1"> on LoadMaster </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ip</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ip_address</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;Cluster #</span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> at </span><span class="si">{}</span><span class="s1"> on LoadMaster </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ip</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ip_address</span><span class="p">)</span>

<div class="viewcode-block" id="Cluster.save"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.Cluster.save">[docs]</a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Cluster</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">update</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span></div>

<div class="viewcode-block" id="Cluster.populate_default_attributes"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.Cluster.populate_default_attributes">[docs]</a>    <span class="k">def</span> <span class="nf">populate_default_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dictionary</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Cluster</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">populate_default_attributes</span><span class="p">(</span><span class="n">dictionary</span><span class="p">)</span>

        <span class="c1"># Clear checkerport if it&#39;s not in use</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;checkerport&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkerport</span> <span class="o">==</span> <span class="s2">&quot;0&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checker</span> <span class="o">!=</span> <span class="s2">&quot;tcp&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">checkerport</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># PD-7338</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">checkerport</span> <span class="o">=</span> <span class="s2">&quot;80&quot;</span></div></div>


<div class="viewcode-block" id="Range"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.Range">[docs]</a><span class="k">class</span> <span class="nc">Range</span><span class="p">(</span><span class="n">BaseKempObject</span><span class="p">):</span>
    <span class="n">_API_ADD</span> <span class="o">=</span> <span class="s2">&quot;/addip&quot;</span>
    <span class="n">_API_MOD_LOC</span> <span class="o">=</span> <span class="s2">&quot;/modiploc&quot;</span>
    <span class="n">_API_DEL_LOC</span> <span class="o">=</span> <span class="s2">&quot;/deliploc&quot;</span>
    <span class="n">_API_ADD_CC</span> <span class="o">=</span> <span class="s2">&quot;/addipcountry&quot;</span>
    <span class="n">_API_DEL_CC</span> <span class="o">=</span> <span class="s2">&quot;/removeipcountry&quot;</span>
    <span class="n">_API_DELETE</span> <span class="o">=</span> <span class="s2">&quot;/delip&quot;</span>
    <span class="n">_API_GET</span> <span class="o">=</span> <span class="s2">&quot;/showip&quot;</span>
    <span class="n">_API_LIST</span> <span class="o">=</span> <span class="s2">&quot;/listips&quot;</span>
    <span class="n">API_TAG</span> <span class="o">=</span> <span class="s2">&quot;IPAddress&quot;</span>
    <span class="n">API_INIT_PARAMS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;ip&quot;</span><span class="p">:</span> <span class="s2">&quot;IPAddress&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mask&quot;</span><span class="p">:</span> <span class="s2">&quot;Mask&quot;</span>
    <span class="p">}</span>
    <span class="n">_API_BASE_PARAMS</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;ip&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mask&quot;</span>
    <span class="p">]</span>
    <span class="n">_API_DEFAULT_ATTRIBUTES</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;Status&quot;</span><span class="p">,</span>
        <span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="s2">&quot;Index&quot;</span><span class="p">,</span>
        <span class="s2">&quot;country&quot;</span><span class="p">:</span> <span class="s2">&quot;Country&quot;</span><span class="p">,</span>
        <span class="s2">&quot;iscustom&quot;</span><span class="p">:</span> <span class="s2">&quot;IsCustom&quot;</span><span class="p">,</span>
        <span class="s2">&quot;long&quot;</span><span class="p">:</span> <span class="s2">&quot;Longitude&quot;</span><span class="p">,</span>
        <span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="s2">&quot;Latitude&quot;</span>
    <span class="p">}</span>
    <span class="n">_API_IGNORE</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;log_urls&quot;</span><span class="p">,</span> <span class="s2">&quot;ip_address&quot;</span><span class="p">,</span> <span class="s2">&quot;endpoint&quot;</span><span class="p">,</span> <span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="s2">&quot;status&quot;</span><span class="p">,</span> <span class="s2">&quot;country&quot;</span><span class="p">,</span>
        <span class="s2">&quot;iscustom&quot;</span><span class="p">,</span> <span class="s2">&quot;mask&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loadmaster_info</span><span class="p">,</span> <span class="n">ip</span><span class="p">,</span> <span class="n">mask</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ip</span> <span class="o">=</span> <span class="n">ip</span>
        <span class="n">validate_ip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ip</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="mi">8</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">&lt;=</span> <span class="mi">32</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">RangeMaskInvalid</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">lat</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">long</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">country</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">iscustom</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">endpoint</span> <span class="o">=</span> <span class="n">loadmaster_info</span><span class="p">[</span><span class="s2">&quot;endpoint&quot;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">RangeMissingLoadmasterInfo</span><span class="p">(</span><span class="s2">&quot;endpoint&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ip_address</span> <span class="o">=</span> <span class="n">loadmaster_info</span><span class="p">[</span><span class="s2">&quot;ip_address&quot;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">RangeMissingLoadmasterInfo</span><span class="p">(</span><span class="s2">&quot;ip_address&quot;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Range</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">loadmaster_info</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;Range </span><span class="si">{}</span><span class="s1">/</span><span class="si">{}</span><span class="s1"> on LoadMaster </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ip</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ip_address</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">latitude</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lat</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">lat</span> <span class="o">/</span> <span class="mi">3600</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@latitude</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">latitude</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lat</span> <span class="o">=</span> <span class="n">value</span> <span class="o">*</span> <span class="mi">3600</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">longitude</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lat</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">long</span> <span class="o">/</span> <span class="mi">3600</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@longitude</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">longitude</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">long</span> <span class="o">=</span> <span class="n">value</span> <span class="o">*</span> <span class="mi">3600</span>

    <span class="k">def</span> <span class="nf">_get_base_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the bare minimum FQDN parameters.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;ip&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ip</span>
        <span class="p">}</span>

<div class="viewcode-block" id="Range.save"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.Range.save">[docs]</a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">update</span><span class="p">:</span>
            <span class="n">base_parameters</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;ip&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ip</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">)</span>
            <span class="p">}</span>

            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_API_ADD</span><span class="p">,</span> <span class="n">base_parameters</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">is_successful</span><span class="p">(</span><span class="n">response</span><span class="p">):</span>
                <span class="k">raise</span> <span class="n">KempTechApiException</span><span class="p">(</span><span class="n">get_error_msg</span><span class="p">(</span><span class="n">response</span><span class="p">))</span>

            <span class="c1"># We need to refresh here, creating the range does not return data</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>

        <span class="c1"># Set Coordinates</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lat</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">long</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_API_MOD_LOC</span><span class="p">,</span>
                                 <span class="bp">self</span><span class="o">.</span><span class="n">to_api_dict</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_API_DEL_LOC</span><span class="p">,</span>
                                 <span class="bp">self</span><span class="o">.</span><span class="n">_get_base_parameters</span><span class="p">())</span>

        <span class="k">if</span> <span class="n">is_successful</span><span class="p">(</span><span class="n">response</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">KempTechApiException</span><span class="p">(</span><span class="n">get_error_msg</span><span class="p">(</span><span class="n">response</span><span class="p">))</span>

        <span class="c1"># Set Country</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">iscustom</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;customloc&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;countrycode&quot;</span>

        <span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">key</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">country</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">country</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">parameters</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_base_parameters</span><span class="p">())</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_API_ADD_CC</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_API_DEL_CC</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_base_parameters</span><span class="p">())</span>

        <span class="k">if</span> <span class="n">is_successful</span><span class="p">(</span><span class="n">response</span><span class="p">):</span>
            <span class="n">range_data</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">populate_default_attributes</span><span class="p">(</span><span class="n">range_data</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">KempTechApiException</span><span class="p">(</span><span class="n">get_error_msg</span><span class="p">(</span><span class="n">response</span><span class="p">))</span></div>

<div class="viewcode-block" id="Range.populate_default_attributes"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.Range.populate_default_attributes">[docs]</a>    <span class="k">def</span> <span class="nf">populate_default_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dictionary</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Range</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">populate_default_attributes</span><span class="p">(</span><span class="n">dictionary</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">country</span> <span class="o">==</span> <span class="s2">&quot;-1&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">country</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lat</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lat</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lat</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">long</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">long</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">long</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="CustomLocation"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.CustomLocation">[docs]</a><span class="k">class</span> <span class="nc">CustomLocation</span><span class="p">(</span><span class="n">BaseKempObject</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loadmaster_info</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">old_name</span> <span class="o">=</span> <span class="n">name</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">endpoint</span> <span class="o">=</span> <span class="n">loadmaster_info</span><span class="p">[</span><span class="s2">&quot;endpoint&quot;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">RangeMissingLoadmasterInfo</span><span class="p">(</span><span class="s2">&quot;endpoint&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ip_address</span> <span class="o">=</span> <span class="n">loadmaster_info</span><span class="p">[</span><span class="s2">&quot;ip_address&quot;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">RangeMissingLoadmasterInfo</span><span class="p">(</span><span class="s2">&quot;ip_address&quot;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">CustomLocation</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">loadmaster_info</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;Custom Location </span><span class="si">{}</span><span class="s1"> on LoadMaster </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ip_address</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_base_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the bare minimum FQDN parameters.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;clname&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s2">&quot;location&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
        <span class="p">}</span>

<div class="viewcode-block" id="CustomLocation.save"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.CustomLocation.save">[docs]</a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">update</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;/addcustomlocation&quot;</span><span class="p">,</span>
                                 <span class="bp">self</span><span class="o">.</span><span class="n">_get_base_parameters</span><span class="p">())</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">is_successful</span><span class="p">(</span><span class="n">response</span><span class="p">):</span>
                <span class="k">raise</span> <span class="n">KempTechApiException</span><span class="p">(</span><span class="n">get_error_msg</span><span class="p">(</span><span class="n">response</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;cloldname&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">old_name</span><span class="p">,</span>
                <span class="s2">&quot;clnewname&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
            <span class="p">}</span>

            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;/editcustomlocation&quot;</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">is_successful</span><span class="p">(</span><span class="n">response</span><span class="p">):</span>
                <span class="c1"># range_data = get_data(response)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">old_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
                <span class="c1"># Unfinished. Need to implement populate_attributes</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">KempTechApiException</span><span class="p">(</span><span class="n">get_error_msg</span><span class="p">(</span><span class="n">response</span><span class="p">))</span></div>

<div class="viewcode-block" id="CustomLocation.delete"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.CustomLocation.delete">[docs]</a>    <span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;/deletecustomlocation&quot;</span><span class="p">,</span>
                             <span class="bp">self</span><span class="o">.</span><span class="n">_get_base_parameters</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">send_response</span><span class="p">(</span><span class="n">response</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="CipherSet"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.CipherSet">[docs]</a><span class="k">class</span> <span class="nc">CipherSet</span><span class="p">(</span><span class="n">BaseKempObject</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loadmaster_info</span><span class="p">,</span> <span class="n">cipherset_name</span><span class="p">,</span> <span class="n">ciphers</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cipherset_name</span> <span class="o">=</span> <span class="n">cipherset_name</span>
        <span class="n">cipher_regex</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">&quot;^([A-Z0-9-]*:*)*[^:]$&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ciphers</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ciphers</span> <span class="o">=</span> <span class="s2">&quot;:&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ciphers</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ciphers</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">cipher_regex</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">ciphers</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ciphers</span> <span class="o">=</span> <span class="n">ciphers</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CipherListInvalid</span><span class="p">(</span><span class="n">ciphers</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">endpoint</span> <span class="o">=</span> <span class="n">loadmaster_info</span><span class="p">[</span><span class="s2">&quot;endpoint&quot;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CertificateMissingLoadmasterInfo</span><span class="p">(</span><span class="s2">&quot;endpoint&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ip_address</span> <span class="o">=</span> <span class="n">loadmaster_info</span><span class="p">[</span><span class="s2">&quot;ip_address&quot;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CertificateMissingLoadmasterInfo</span><span class="p">(</span><span class="s2">&quot;ip_address&quot;</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">CipherSet</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">loadmaster_info</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;Cipher List </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ciphers</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_base_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the bare minimum cipherset parameters&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">cipherset_name</span><span class="p">,</span>
            <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ciphers</span>
        <span class="p">}</span>

<div class="viewcode-block" id="CipherSet.save"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.CipherSet.save">[docs]</a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s1">&#39;/modifycipherset&#39;</span><span class="p">,</span>
                             <span class="n">parameters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_base_parameters</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">is_successful</span><span class="p">(</span><span class="n">response</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">KempTechApiException</span><span class="p">(</span><span class="n">get_error_msg</span><span class="p">(</span><span class="n">response</span><span class="p">))</span></div>

<div class="viewcode-block" id="CipherSet.delete"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.CipherSet.delete">[docs]</a>    <span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;/delcipherset&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_base_parameters</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">send_response</span><span class="p">(</span><span class="n">response</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Certificate"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.Certificate">[docs]</a><span class="k">class</span> <span class="nc">Certificate</span><span class="p">(</span><span class="n">BaseKempObject</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loadmaster_info</span><span class="p">,</span> <span class="n">certname</span><span class="p">,</span>
                 <span class="n">certfile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">certpass</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">certname</span> <span class="o">=</span> <span class="n">certname</span>

        <span class="c1"># If certname is a structure, pull out the name and set the modulus</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">certname</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">modulus</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">certname</span><span class="p">[</span><span class="s1">&#39;modulus&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">certname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">certname</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">certfile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">certfile</span> <span class="o">=</span> <span class="n">certfile</span>

        <span class="k">if</span> <span class="n">certpass</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">certpass</span> <span class="o">=</span> <span class="n">certpass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">certpass</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">endpoint</span> <span class="o">=</span> <span class="n">loadmaster_info</span><span class="p">[</span><span class="s2">&quot;endpoint&quot;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CertificateMissingLoadmasterInfo</span><span class="p">(</span><span class="s2">&quot;endpoint&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ip_address</span> <span class="o">=</span> <span class="n">loadmaster_info</span><span class="p">[</span><span class="s2">&quot;ip_address&quot;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CertificateMissingLoadmasterInfo</span><span class="p">(</span><span class="s2">&quot;ip_address&quot;</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">Certificate</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">loadmaster_info</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;Certificate </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">certname</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_base_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the bare minimum VS parameters. IP, port and protocol&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">certpass</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="s2">&quot;cert&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">certname</span><span class="p">,</span>
                <span class="s2">&quot;replace&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span>
            <span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="s2">&quot;cert&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">certname</span><span class="p">,</span>
                <span class="s2">&quot;replace&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span>
                <span class="s2">&quot;password&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">certpass</span>
            <span class="p">}</span>

<div class="viewcode-block" id="Certificate.save"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.Certificate.save">[docs]</a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_post</span><span class="p">(</span><span class="s2">&quot;/addcert&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">certfile</span><span class="p">,</span>
                              <span class="n">parameters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_base_parameters</span><span class="p">())</span>

        <span class="k">if</span> <span class="n">is_successful</span><span class="p">(</span><span class="n">response</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">KempTechApiException</span><span class="p">(</span><span class="n">get_error_msg</span><span class="p">(</span><span class="n">response</span><span class="p">))</span></div>

<div class="viewcode-block" id="Certificate.delete"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.Certificate.delete">[docs]</a>    <span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;/delcert&quot;</span><span class="p">,</span>
                             <span class="bp">self</span><span class="o">.</span><span class="n">_get_base_parameters</span><span class="p">())</span>

        <span class="k">return</span> <span class="n">send_response</span><span class="p">(</span><span class="n">response</span><span class="p">)</span></div>

<div class="viewcode-block" id="Certificate.populate_default_attributes"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.Certificate.populate_default_attributes">[docs]</a>    <span class="k">def</span> <span class="nf">populate_default_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dictionary</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Certificate</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">populate_default_attributes</span><span class="p">(</span><span class="n">dictionary</span><span class="p">)</span>

        <span class="c1"># If certname is a structure, pull out the name and set the modulus</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">certname</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">modulus</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">certname</span><span class="p">[</span><span class="s1">&#39;modulus&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">certname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">certname</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span></div></div>


<div class="viewcode-block" id="IntermediateCertificate"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.IntermediateCertificate">[docs]</a><span class="k">class</span> <span class="nc">IntermediateCertificate</span><span class="p">(</span><span class="n">BaseKempObject</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loadmaster_info</span><span class="p">,</span> <span class="n">certname</span><span class="p">,</span> <span class="n">certfile</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">certname</span> <span class="o">=</span> <span class="n">certname</span>

        <span class="c1"># If certname is a structure, pull out the name and set the modulus</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">certname</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">modulus</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">certname</span><span class="p">[</span><span class="s1">&#39;modulus&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">certname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">certname</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">certfile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">certfile</span> <span class="o">=</span> <span class="n">certfile</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">endpoint</span> <span class="o">=</span> <span class="n">loadmaster_info</span><span class="p">[</span><span class="s2">&quot;endpoint&quot;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CertificateMissingLoadmasterInfo</span><span class="p">(</span><span class="s2">&quot;endpoint&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ip_address</span> <span class="o">=</span> <span class="n">loadmaster_info</span><span class="p">[</span><span class="s2">&quot;ip_address&quot;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CertificateMissingLoadmasterInfo</span><span class="p">(</span><span class="s2">&quot;ip_address&quot;</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">IntermediateCertificate</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">loadmaster_info</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;Intermediate Certificate </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">certname</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_base_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the bare minimum VS parameters. IP, port and protocol&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;cert&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">certname</span><span class="p">,</span>
        <span class="p">}</span>

<div class="viewcode-block" id="IntermediateCertificate.save"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.IntermediateCertificate.save">[docs]</a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_post</span><span class="p">(</span><span class="s2">&quot;/addintermediate&quot;</span><span class="p">,</span>
                              <span class="n">file</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">certfile</span><span class="p">,</span>
                              <span class="n">parameters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_base_parameters</span><span class="p">())</span>

        <span class="k">if</span> <span class="n">is_successful</span><span class="p">(</span><span class="n">response</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">KempTechApiException</span><span class="p">(</span><span class="n">get_error_msg</span><span class="p">(</span><span class="n">response</span><span class="p">))</span></div>

<div class="viewcode-block" id="IntermediateCertificate.delete"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.IntermediateCertificate.delete">[docs]</a>    <span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="s2">&quot;/delintermediate&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_base_parameters</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">send_response</span><span class="p">(</span><span class="n">response</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Interface"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.Interface">[docs]</a><span class="k">class</span> <span class="nc">Interface</span><span class="p">(</span><span class="n">BaseKempObject</span><span class="p">):</span>
    <span class="n">_API_MOD</span> <span class="o">=</span> <span class="s2">&quot;/modiface&quot;</span>
    <span class="n">_API_GET</span> <span class="o">=</span> <span class="s2">&quot;/showiface&quot;</span>
    <span class="n">_API_LIST</span> <span class="o">=</span> <span class="s2">&quot;/stats&quot;</span>
    <span class="n">_API_ADD_ADDRESS</span> <span class="o">=</span> <span class="s2">&quot;/addadditional&quot;</span>
    <span class="n">_API_DELETE_ADDRESS</span> <span class="o">=</span> <span class="s2">&quot;/deladditional&quot;</span>
    <span class="n">API_TAG</span> <span class="o">=</span> <span class="s2">&quot;Interface&quot;</span>
    <span class="n">_API_LIST_TAG</span> <span class="o">=</span> <span class="s2">&quot;Network&quot;</span>
    <span class="n">API_INIT_PARAMS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;interface&quot;</span><span class="p">:</span> <span class="s2">&quot;Id&quot;</span>
    <span class="p">}</span>
    <span class="n">_API_BASE_PARAMS</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;interface&quot;</span><span class="p">:</span> <span class="s2">&quot;Id&quot;</span>
    <span class="p">}</span>
    <span class="n">_API_DEFAULT_ATTRIBUTES</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;interface&quot;</span><span class="p">:</span> <span class="s2">&quot;Id&quot;</span><span class="p">,</span>
        <span class="s2">&quot;addr&quot;</span><span class="p">:</span> <span class="s2">&quot;IPAddress&quot;</span><span class="p">,</span>
        <span class="s2">&quot;shared&quot;</span><span class="p">:</span> <span class="s2">&quot;SharedIPAddress&quot;</span><span class="p">,</span>
        <span class="s2">&quot;partner&quot;</span><span class="p">:</span> <span class="s2">&quot;PartnerIPAddress&quot;</span><span class="p">,</span>
        <span class="s2">&quot;hacheck&quot;</span><span class="p">:</span> <span class="s2">&quot;hacheck&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mtu&quot;</span><span class="p">:</span> <span class="s2">&quot;Mtu&quot;</span><span class="p">,</span>
        <span class="s2">&quot;interfacetype&quot;</span><span class="p">:</span> <span class="s2">&quot;InterfaceType&quot;</span><span class="p">,</span>
        <span class="s2">&quot;geotraffic&quot;</span><span class="p">:</span> <span class="s2">&quot;GeoTrafficEnable&quot;</span><span class="p">,</span>
        <span class="s2">&quot;gwiface&quot;</span><span class="p">:</span> <span class="s2">&quot;DefaultInterface&quot;</span><span class="p">,</span>
        <span class="s2">&quot;additionaladdresses&quot;</span><span class="p">:</span> <span class="s2">&quot;AdditionalAddresses&quot;</span><span class="p">,</span>
        <span class="s2">&quot;adminwuienable&quot;</span><span class="p">:</span> <span class="s2">&quot;AdminWuiEnable&quot;</span>
    <span class="p">}</span>
    <span class="n">_API_IGNORE</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;log_urls&quot;</span><span class="p">,</span> <span class="s2">&quot;ip_address&quot;</span><span class="p">,</span> <span class="s2">&quot;endpoint&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span>
        <span class="s2">&quot;interfacetype&quot;</span><span class="p">,</span> <span class="s2">&quot;additionaladdresses&quot;</span>
    <span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loadmaster_info</span><span class="p">,</span> <span class="n">interface</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Interface constructor</span>

<span class="sd">        :param loadmaster_info: LoadMaster access_info</span>
<span class="sd">        :param interface: LoadMaster interface ID.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">interface</span> <span class="o">=</span> <span class="n">interface</span>
        <span class="c1"># Set addr and cidr to empty strings to allow the properties</span>
        <span class="c1"># to work correctly when there are no IPs or CIDR set.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addr</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cidr</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shared</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">partner</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">populate_default_attributes</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Interface</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">loadmaster_info</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;Interface </span><span class="si">{}</span><span class="s1"> on LoadMaster </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">interface</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ip_address</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">address</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># self.addr can be None as it is not mandatory for an interface to have an address</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">addr</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">addr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="nd">@address</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">address</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addr</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">/</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cidr</span><span class="p">)</span> <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">cidr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">addr</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">addr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="nd">@cidr</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">cidr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addr</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">/</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">address</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>

<div class="viewcode-block" id="Interface.save"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.Interface.save">[docs]</a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">update</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="c1"># pylint: disable=duplicate-code</span>
        <span class="c1"># Duplicate code required due to the lacking nature of interfaces API</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_api_dict</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;interface&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">interface</span><span class="p">,</span>
                <span class="n">key</span><span class="p">:</span> <span class="n">value</span>
            <span class="p">}</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_API_MOD</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">KempTechApiException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;Nothing Modified&quot;</span><span class="p">:</span>
                    <span class="k">pass</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_is_successful_or_raise</span><span class="p">(</span><span class="n">response</span><span class="p">)</span></div>

<div class="viewcode-block" id="Interface.stats"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.Interface.stats">[docs]</a>    <span class="k">def</span> <span class="nf">stats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span>  <span class="c1"># pylint: disable=protected-access</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_API_LIST</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
            <span class="n">xml_object</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_API_LIST_TAG</span><span class="p">,</span> <span class="p">[])</span>
        <span class="k">except</span> <span class="n">KempTechApiException</span><span class="p">:</span>
            <span class="n">xml_object</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># If there is no API_TAG key, build will fail with a</span>
        <span class="c1"># ValidationError, which is the best we can do for now</span>
        <span class="c1"># (without changing the upstream code and raising an</span>
        <span class="c1"># exception earlier, possibly retrying)</span>

        <span class="n">stats</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">interface_details</span> <span class="ow">in</span> <span class="n">xml_object</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">interface_details</span><span class="p">[</span><span class="s1">&#39;ifaceID&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">interface</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">interface_details</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">stats</span><span class="p">[</span><span class="n">k</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span> <span class="o">=</span> <span class="n">v</span>

        <span class="k">return</span> <span class="n">stats</span></div>

<div class="viewcode-block" id="Interface.populate_default_attributes"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.Interface.populate_default_attributes">[docs]</a>    <span class="k">def</span> <span class="nf">populate_default_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span> <span class="k">if</span> <span class="n">params</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">params</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Interface</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">populate_default_attributes</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>

        <span class="c1"># Strip additional addresses into a list</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;additionaladdresses&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">additionaladdresses</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">additionaladdresses</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">additionaladdresses</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">additionaladdresses</span><span class="p">,</span> <span class="n">OrderedDict</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">additionaladdresses</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">additionaladdresses</span><span class="p">[</span><span class="s1">&#39;IPaddress&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">additionaladdresses</span> <span class="o">=</span> <span class="n">cast_to_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">additionaladdresses</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;geotraffic&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">geotraffic</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">geotraffic</span> <span class="o">==</span> <span class="s2">&quot;no&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">geotraffic</span> <span class="o">=</span> <span class="s2">&quot;0&quot;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">geotraffic</span> <span class="o">==</span> <span class="s2">&quot;yes&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">geotraffic</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_additionaladdresses</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">address</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">additionaladdresses</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_additionaladdresses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">address</span><span class="p">)</span></div>

<div class="viewcode-block" id="Interface.set_additionaladdresses"><a class="viewcode-back" href="../../python_kemptech_api.objects.html#python_kemptech_api.objects.Interface.set_additionaladdresses">[docs]</a>    <span class="k">def</span> <span class="nf">set_additionaladdresses</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">new</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">additionaladdresses</span>
        <span class="n">old</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_additionaladdresses</span>

        <span class="k">for</span> <span class="n">address</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">old</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">new</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_delete_additionaladdress</span><span class="p">(</span><span class="n">address</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">address</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">new</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">old</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_additionaladdress</span><span class="p">(</span><span class="n">address</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="nf">_add_additionaladdress</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">):</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;interface&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">interface</span><span class="p">,</span>
            <span class="s2">&quot;addr&quot;</span><span class="p">:</span> <span class="n">address</span>
        <span class="p">}</span>

        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span>  <span class="c1"># pylint: disable=protected-access</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_API_ADD_ADDRESS</span><span class="p">,</span>
            <span class="n">parameters</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_successful</span><span class="p">(</span><span class="n">response</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">KempTechApiException</span><span class="p">(</span><span class="n">get_error_msg</span><span class="p">(</span><span class="n">response</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_delete_additionaladdress</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">):</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;interface&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">interface</span><span class="p">,</span>
            <span class="s2">&quot;addr&quot;</span><span class="p">:</span> <span class="n">address</span>
        <span class="p">}</span>

        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span>  <span class="c1"># pylint: disable=protected-access</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_API_DELETE_ADDRESS</span><span class="p">,</span>
            <span class="n">parameters</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_successful</span><span class="p">(</span><span class="n">response</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">KempTechApiException</span><span class="p">(</span><span class="n">get_error_msg</span><span class="p">(</span><span class="n">response</span><span class="p">))</span></div>
</pre></div>

           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, KEMP Technologies.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'0.7.18',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>